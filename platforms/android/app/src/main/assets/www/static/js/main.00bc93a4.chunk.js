(this["webpackJsonpcom.kinghoddy.skychat"]=this["webpackJsonpcom.kinghoddy.skychat"]||[]).push([[0],[,,,,,,,,,function(e,t,a){},,function(e,t,a){},function(e,t,a){},,,,function(e,t,a){},,,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){e.exports=a.p+"static/media/logo_red.928347b4.png"},,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,function(e,t,a){e.exports=a.p+"static/media/google.5449b457.png"},function(e,t,a){e.exports=a.p+"static/media/avatar_square.8361f480.png"},function(e,t,a){},,function(e,t,a){},,,,function(e,t,a){},,,function(e,t,a){e.exports=a.p+"static/media/chatBg.7b1d8e86.jpg"},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,,,,,function(e,t,a){},,function(e,t,a){},function(e,t,a){e.exports=a.p+"static/media/skychat_red.3a297777.png"},function(e,t,a){e.exports=a.p+"static/media/skychat_blue.d0a83b3a.png"},function(e,t,a){e.exports=a.p+"static/media/logo_blue.57212198.png"},function(e,t,a){e.exports=a.p+"static/media/skychat_light_1.ab507a4e.png"},,,function(e,t,a){e.exports=a.p+"static/media/ui_loading.c3967b09.wav"},function(e,t,a){e.exports=a.p+"static/media/completed.fb29553b.wav"},function(e,t,a){e.exports=a.p+"static/media/chat_bg_dark.162ad9a8.jpg"},function(e,t,a){e.exports=a.p+"static/media/group.c652c7ee.png"},function(e,t,a){},function(e,t,a){e.exports=a.p+"static/media/friends.cbf4c1f7.png"},function(e,t,a){e.exports=a.p+"static/media/avatar-red.6399edc5.png"},function(e,t,a){e.exports=a(94)},,,,,function(e,t,a){},,,function(e,t,a){e.exports=a.p+"static/media/skychat_light_2.d9e462c3.png"},,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(62),l=a.n(r),o=(a(84),a(4)),c=a(5),i=a(7),m=a(6),u=a(2),d=a(21),h=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.props.show&&document.getElementById("mBtn").click()}},{key:"render",value:function(){return this.props.show?s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{type:"button",id:"mBtn",className:"d-none","data-toggle":"modal","data-target":"#modelId"},"Launch"),s.a.createElement("div",{className:"modal fade",id:"modelId",tabIndex:"-1",role:"dialog"},s.a.createElement("div",{className:"modal-dialog",role:"document"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title"},this.props.title),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"modal-body"},this.props.children),this.props.btn?s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{onClick:this.props.click,style:{background:"orangered",color:"white"},type:"button",className:"btn"},this.props.btn)):null)))):null}}]),a}(n.Component),p=a(63),g=a.n(p),f=function(e){return s.a.createElement("div",{className:g.a.toast+" rounded-pill"},e.children)},v=a(8),b=a(22),E=a.n(b),y=a(41),N=a.n(y),k=a(47),w=a.n(k),S=function(e){return s.a.createElement("div",{className:"h-100 w-100 d-flex flex-column align-items-center justify-content-center "},s.a.createElement("div",{className:"rounded-circle "+w.a.spinner,style:Object(v.a)({},e.style)},s.a.createElement("div",{style:{fontSize:e.fontSize},className:w.a.Loader},"Loading...")),e.message?s.a.createElement("h4",{className:e.size+" text-center",style:{paddingTop:"6rem"}},e.message):"")},x=a(42);a(95);x.initializeApp({apiKey:"AIzaSyCKMoKc1Cft0WG1etZLvnmh5ytzdckkIcg",authDomain:"skymail-920ab.firebaseapp.com",databaseURL:"https://skymail-920ab.firebaseio.com",projectId:"skymail-920ab",storageBucket:"skymail-920ab.appspot.com",messagingSenderId:"795125035544",appId:"1:795125035544:web:bc6cddb5e006c3bfdd496d",measurementId:"G-Z3K3MYS9NC"}),x.analytics();var D=x,C=a(65),j=a.n(C),I=function(e){var t=null;switch(e.elementType){case"input":t=s.a.createElement("input",Object.assign({className:"form-control  "},e.elementConfig,{value:e.value,id:e.id,onChange:e.changed}));break;case"checkbox":t=s.a.createElement("input",{className:"custom-control-input  ",id:e.id,type:"checkbox",onChange:e.changed});break;case"textarea":t=s.a.createElement("textarea",Object.assign({className:"form-control"},e.elementConfig,{value:e.value,onChange:e.changed}));break;case"select":t=s.a.createElement("select",{className:"form-control",value:e.value,onChange:e.changed},e.elementConfig.options.map((function(e){return s.a.createElement("option",{key:e.value,value:e.value},e.displayValue)})));break;default:t=s.a.createElement("input",Object.assign({},e.elementConfig,{value:e.value,className:"form-control",onChange:e.changed}))}var a=null;return a="checkbox"===e.elementType?s.a.createElement("div",{className:"custom-control custom-checkbox mb-3  wow fadeIn"},t,s.a.createElement("label",{htmlFor:e.id,className:"custom-control-label"},e.label)):s.a.createElement("div",{className:j.a.formLabelGroup+" wow fadeIn"},t,s.a.createElement("label",{htmlFor:e.id},e.label)),s.a.createElement(s.a.Fragment,null,a)},M=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={form:{search:{elementType:"input",elementConfig:{type:"text",placeholder:"Search for a user",required:!0},value:"",id:"search",label:"Search for a user"}}},e.inputChanged=function(t,a){var n=Object(v.a)({},e.state.form),s=Object(v.a)({},n[a]);s.value=t.target.value,n[a]=s,e.setState({form:n})},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=[];for(var a in this.state.form)t.push({id:a,config:this.state.form[a]});return s.a.createElement("form",{onSubmit:this.props.submit},t.map((function(t){return s.a.createElement(I,{elementType:t.config.elementType,elementConfig:t.config.elementConfig,value:t.config.value,id:t.id,key:t.config.id,label:t.config.label,changed:function(a){e.inputChanged(a,t.id)}})})))}}]),a}(n.Component),O=(a(18),a(66)),P=a.n(O),U=a(67),F=a.n(U),L=a(28),T=a.n(L),A=a(68),R=a.n(A),q=a(69),B=a.n(q),H=(a(87),a(25)),_=a.n(H),z=function(e){return"l1"===e.type?s.a.createElement("div",{className:_.a.Logo,style:{height:e.height,width:e.width}},s.a.createElement("img",{src:P.a,alt:"skychat Logo1"})):"l2"===e.type?s.a.createElement("div",{className:_.a.Logo,style:{height:e.height,width:e.width}},s.a.createElement("img",{src:F.a,alt:"skychat Logo"})):"l3"===e.type?s.a.createElement("div",{className:_.a.Logo,style:{height:e.height,width:e.width}},s.a.createElement("img",{src:T.a,alt:"skychat Logo"})):"l4"===e.type?s.a.createElement("div",{className:_.a.Logo,style:{height:e.height,width:e.width}},s.a.createElement("img",{src:R.a,alt:"skychat Logo"})):"l5"===e.type?s.a.createElement("div",{className:_.a.Logo,style:{height:e.height,width:e.width}},s.a.createElement("img",{src:B.a,alt:"skychat Logo"})):"l6"===e.type?s.a.createElement("div",{className:_.a.Logo,style:{height:e.height,width:e.width}},s.a.createElement("img",{src:"res/logo/skychat_light_2.png",alt:"skychat Logo"})):s.a.createElement("h5",null,"Cant load logo")},Y=function(e){return s.a.createElement("div",{className:"h-100 w-100 d-flex align-items-center justify-content-center"},s.a.createElement("div",{className:"rounded-circle d-flex align-items-center",style:{background:"rgba(255,255,255,.5)",height:"20rem",width:"20rem"}},s.a.createElement("div",{className:"mx-auto"},s.a.createElement(z,{type:"l4",height:"5rem"}),s.a.createElement("h3",{className:"mt-3 text-center"},"Start a chat"))))},G=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={loading:!1,hasChats:!1,message:null,chats:[]},e.getChats=function(t,a){e.setState({message:"Fetching user data"}),D.database().ref("users/"+t+"/chatsId").on("value",(function(n){var s=n.val();if(s){e.setState({message:"Loading Chats",loading:!0}),e.setState({hasChats:!0});var r=[],l=function(n){var l=s[n];D.database().ref("chats/"+l).on("value",(function(n){var s,o,c=n.val().metadata,i=n.val().chats,m=n.val().description,u=n.val().modified;if(i){var d=(s=i[Object.keys(i)[Object.keys(i).length-1]]).message,h=new Date(s.date);u||(u=s.date);var p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Sep","Oct","Nov","Dec"][h.getMonth()],g=h.getFullYear(),f=h.getDate(),v=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][h.getDay()],b=h.getHours(),E=(o=h.getMinutes())<10?"0"+o:o,y=h.getTime(),N=" am";b>11&&(N=" pm"),b>12&&(b-=12);var k=new Date;if(y=k.getDate()===f?b+":"+E+N:k.getDate()-f===1||k.getDate()-f===-30?"Yesterday "+b+":"+E+N:k.getDate()-f>1&&k.getDate()-f<7?v+" at "+b+":"+E+N:g===k.getFullYear()?p+" "+f+" at "+b+":"+E+N:g>k.getFullYear()?p+" "+f+" "+g+" at "+b+":"+E+N:v+"  "+b+":"+E+N,s.sender!==t&&s.sender!==a||(d="You: "+s.message),void 0!==m){var w={chatHead:l,icon:n.val().icon,link:l,lastChat:d,modified:u,time:y};r.forEach((function(e,t){e.chatHead===w.chatHead&&r.splice(t,1)})),r.push(w),e.setState({chats:r.reverse()})}else for(var S in c)S!==t&&D.database().ref("users/"+S).on("value",(function(t){var a={chatHead:t.val().username,icon:t.val().profilePicture,modified:u,link:l,lastChat:d,time:y};r.forEach((function(e,t){e.chatHead===a.chatHead&&r.splice(t,1)})),r.sort((function(e,t){return e.modified-t.modified})),r.push(a),e.setState({chats:r.reverse()})}));e.setState({loading:!1})}}))};for(var o in s){l(o)}}else e.setState({loading:!1})}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0,message:"Connecting to database"}),D.auth().onAuthStateChanged((function(t){if(t){var a=t.uid;e.getChats(a,t.displayName)}else console.log("no user found")}))}},{key:"render",value:function(){return s.a.createElement("div",{className:N.a.Chats+" h-100"},this.state.loading?s.a.createElement(S,{size:"h6",message:this.state.message}):this.state.hasChats?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"px-3 pt-2"},s.a.createElement(M,null)),this.state.chats.map((function(e){return s.a.createElement(u.b,{to:"/messages/"+e.link,className:N.a.Chat+" px-3 py-2 text-capitalize  border-bottom d-flex align-items-center",key:e.link},s.a.createElement("div",{className:N.a.picture},s.a.createElement("img",{src:e.icon,alt:""})),s.a.createElement("div",{style:{minWidth:"11rem"},className:"ml-3 text-dark  "},s.a.createElement("h3",{className:" font-weight-bold h5 m-0"},e.chatHead?e.chatHead.split("<br/>").join(" ").substring(0,15)+(Array.from(e.chatHead).length>15?"...":""):null),s.a.createElement("p",{className:"m-0"},e.lastChat.split?e.lastChat.split("<br/>").join(" ").substring(0,21)+(Array.from(e.lastChat).length>21?" ...":""):null)),s.a.createElement("div",{className:"text-right ml-auto"},s.a.createElement("h6",{style:{color:"#888"}},e.time),e.seen?null:s.a.createElement("i",{style:{fontSize:"1rem",color:"orangered"},className:"material-icons pr-1"},"radio_button_checked")))})),s.a.createElement("p",{className:"my-4 mx-auto text-secondary text-center"},"No more chats"," ")):s.a.createElement("div",{className:"text-center"},s.a.createElement(Y,null)))}}]),a}(n.Component),W=a(32),J=a.n(W),K=a(33),V=a.n(K),Z=function(e){var t="auto",a=document.getElementById("t");return a&&(t="auto",(t=a.scrollHeight)>55?e.changeStyle(!0):e.changeStyle(!1)),s.a.createElement("form",{onSubmit:e.sendChat,className:V.a.msgInput+" row no-gutters"},s.a.createElement("div",{className:"col-md-2 col-5 justify-content-around pb-1  d-flex align-items-center",style:{alignSelf:"flex-end"}},s.a.createElement("button",{onClick:function(){a.style.height="auto",e.changeStyle(!1)},className:V.a.btn},s.a.createElement("i",{className:"material-icons o"},"photo")),s.a.createElement("button",{onClick:function(){a.style.height="auto",e.changeStyle(!1)},className:V.a.btn},s.a.createElement("i",{className:"material-icons "},"videocam")),s.a.createElement("button",{onClick:function(){a.style.height="auto",e.changeStyle(!1)},className:V.a.btn},s.a.createElement("i",{className:"material-icons "},"audiotrack"))),s.a.createElement("div",{className:"col pt-1"},s.a.createElement("textarea",{id:"t",style:{height:t+"px"},rows:"1",type:"text",required:!0,onChange:e.changed,value:e.value,placeholder:"Aa"})),s.a.createElement("div",{className:"col-md-1 col-2 pb-1  d-flex align-items-center",style:{alignSelf:"flex-end"}},s.a.createElement("button",{onClick:function(){a.style.height="auto",e.changeStyle(!1)},className:"w-100 p-0 d-flex align-items-center",style:{border:0,outline:0,background:"none"}},s.a.createElement("i",{className:"material-icons h-100 mx-auto",style:{fontSize:"2.5rem",lineHeight:"1",color:"orangered"}},"send"))))},X=a(9),$=a.n(X),Q=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).chatRef=s.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this.chatRef.current.className;this.chatRef.current.offsetHeight>55&&this.chatRef.current.offsetHeight<80?e=[e,$.a.lg].join(" "):this.chatRef.current.offsetHeight>80&&(e=[e,$.a.lg2].join(" ")),this.chatRef.current.className=e}},{key:"render",value:function(){var e,t="",a=D.auth().currentUser,n=$.a.sent,r=this.props.children;if(this.props.sender===a.uid||this.props.sender===a.displayName)n=$.a.sent,t=null;else if("time"===this.props.sender){var l=new Date(this.props.date),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Sep","Oct","Nov","Dec"][l.getMonth()],c=l.getFullYear(),i=l.getDate(),m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()],u=l.getHours(),d=(e=l.getMinutes())<10?"0"+e:e,h=" am";u>12&&(h=" pm",u-=12),n=$.a.time,t=null;var p=new Date,g=(p.getTime()-l.getTime())/36e5;r=p.getDate()===i?"Today at "+u+":"+d+h:p.getDate()-i===1||p.getDate()-i===-30||g>24&&g<48?"Yesterday at "+u+":"+d+h:p.getDate()-i>1&&p.getDate()-i<7?m+" at "+u+":"+d+h:c===p.getFullYear()?o+" "+i+" at "+u+":"+d+h:c>p.getFullYear()?o+" "+i+" "+c+" at "+u+":"+d+h:m+" at "+u+":"+d+h}else"skymail"===this.props.sender?(n=$.a.skymail,t=null):"added"===this.props.sender?(n=$.a.added,this.props.added&&(this.props.added.toLowerCase()===a.displayName.toLowerCase()?r+=" added You":r+=" added "+this.props.added)):(n=$.a.received,t=s.a.createElement("div",{className:$.a.icon+" mr-2 mr-md-2"},s.a.createElement("img",{src:this.props.icon,alt:""})));return s.a.createElement("div",{className:"d-flex"},t,s.a.createElement("div",{ref:this.chatRef,dangerouslySetInnerHTML:{__html:r},className:[$.a.chat,n].join(" ")}))}}]),a}(n.Component),ee=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).chatRef=s.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this.chatRef.current.className;this.chatRef.current.offsetHeight>40&&this.chatRef.current.offsetHeight<80?e=[e,$.a.lg].join(" "):this.chatRef.current.offsetHeight>80&&(e=[e,$.a.lg2].join(" ")),this.chatRef.current.className=e}},{key:"render",value:function(){var e,t="",a=D.auth().currentUser,n=$.a.sent,r=this.props.children;if(this.props.sender===a.uid||this.props.sender===a.displayName)n=$.a.sent,t=null;else if("time"===this.props.sender){var l=new Date(this.props.date),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Sep","Oct","Nov","Dec"][l.getMonth()],c=l.getFullYear(),i=l.getDate(),m=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][l.getDay()],u=l.getHours(),d=(e=l.getMinutes())<10?"0"+e:e,h=" am";u>12&&(h=" pm",u-=12),n=$.a.time,t=null;var p=new Date,g=(p.getTime()-l.getTime())/36e5;r=p.getDate()===i?"Today at "+u+":"+d+h:p.getDate()-i===1||p.getDate()-i===-30||g>24&&g<48?"Yesterday at "+u+":"+d+h:p.getDate()-i>1&&p.getDate()-i<7?m+" at "+u+":"+d+h:c===p.getFullYear()?o+" "+i+" at "+u+":"+d+h:c>p.getFullYear()?o+" "+i+" "+c+" at "+u+":"+d+h:m+" at "+u+":"+d+h}else"skymail"===this.props.sender?(n=$.a.skymail,t=null):"added"===this.props.sender?(n=$.a.added,this.props.added&&(this.props.added.toLowerCase()===a.displayName.toLowerCase()?r+=" added You":r+=" added "+this.props.added)):(n=$.a.received,t=s.a.createElement("div",{className:$.a.icon+" mr-2 mr-md-2"},s.a.createElement("img",{src:this.props.icon,alt:""})));var f=Math.floor(6*Math.random());return s.a.createElement("div",{className:"d-flex"},t,s.a.createElement("div",{ref:this.chatRef,className:[$.a.gchat,n].join(" ")},s.a.createElement("p",{style:{color:[" rgb(43, 144, 226)","rgb(226, 177, 43)","#62a","#e22"," rgb(43, 226, 52)","rgb(226, 43, 180)"][f]},className:$.a.name},this.props.name," "),s.a.createElement("span",{dangerouslySetInnerHTML:{__html:r}})))}}]),a}(n.Component),te=(a(14),a(72)),ae=a.n(te),ne=a(73),se=a.n(ne),re=function(e){var t=document.createElement("audio");t.src="success"===e?se.a:ae.a,t.play()},le=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={value:"",path:null,chats:[],receiverData:{},senderData:{senderId:""},loading:!1,description:void 0,date:null,isGroup:!0,changeStyle:!1},e.inputChanged=function(t){e.setState({value:t.target.value})},e.changeStyle=function(t){if(e.state.changeStyle!==t){e.setState({changeStyle:t});var a=document.getElementById("scroll");a&&setTimeout((function(){a.scrollTop=a.scrollHeight+1e5}),500)}},e.getChats=function(t,a){D.database().ref("chats/"+t).on("value",(function(t){var a,n;if(console.log(t.val()),t.val()&&(a=t.val().description,n=t.val().icon),void 0!==a){var s;!function(){e.setState({isGroup:!0,description:a,groupIcon:n});var o={},c=function(a){if(D.database().ref("users/"+a).once("value",(function(e){o[a]={profilePicture:e.val().profilePicture,username:e.val().username}})),r=[],t.val())for(var n in t.val().chats){var c=Object(v.a)({},t.val().chats[n]);o[c.sender]&&(c.name=o[c.sender].username,c.profilePicture=o[c.sender].profilePicture),r.push(c)}(l=r[Object.keys(r)[Object.keys(r).length-1]]).sender!==e.state.senderData.senderId&&"time"!==l.sender&&l.sender&&"skymail"!==l.sender&&e.state.senderData.senderId&&re(),e.setState({chats:r,date:l.date,loading:!1}),(s=document.getElementById("scroll"))&&setTimeout((function(){s.scrollTop=s.scrollHeight+100}),500)};for(var i in t.val().metadata)c(i);e.setState({members:o})}()}else{var r;if(e.setState({isGroup:!1}),t.val()&&(r=t.val().chats),r){var l,o=[];for(var c in r){var i=r[c];o.push(i)}(l=r[Object.keys(r)[Object.keys(r).length-1]]).sender!==e.state.senderData.senderId&&"time"!==l.sender&&l.sender&&"skymail"!==l.sender&&e.state.senderData.senderId&&re(),e.setState({chats:o,date:l.date,loading:!1})}var m=function(t){e.state.senderData.senderId&&t!==e.state.senderData.senderId&&D.database().ref("users/"+t).on("value",(function(a){var n={};n.profilePicture=a.val().profilePicture,n.username=a.val().username,n.uid=t,e.setState({receiverData:n}),document.title=n.username+" And "+e.state.senderData.username+" | Skychat",setTimeout((function(){var e=document.getElementById("scroll");e.scrollTop=e.scrollHeight+100}),50)}))};for(var u in t.val().metadata)m(u)}}))},e.sendChats=function(t){e.setState({changeStyle:!1}),t.preventDefault();var a=e.props.match.params.chatId,n=D.database().ref("chats/"+a+"/chats"),s=e.state.value.split("\n").join("<br/>"),r=Date.now();D.database().ref("chats/"+a+"/modified").set(r),((new Date).getTime()-new Date(e.state.date).getTime())/1e3>125?(n.push({date:r,message:r,sender:"time"}),n.push({date:r,message:s,sender:e.state.senderData.senderId})):n.push({date:r,message:s,sender:e.state.senderData.senderId}),e.setState({value:""})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({loading:!0}),D.auth().onAuthStateChanged((function(t){if(t){var a={};a.senderId=t.uid,a.username=t.displayName,a.profilePicture=t.photoURL,e.setState({senderData:a}),e.getChats(e.props.match.params.chatId)}else e.setState({loading:!1})}))}},{key:"componentDidUpdate",value:function(){this.props.match.params.chatId!==this.state.chatId&&(this.setState({chatId:this.props.match.params.chatId}),this.getChats(this.props.match.params.chatId))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:J.a.chatroom},s.a.createElement("nav",{className:J.a.navbar+"  navbar navbar-expand navbar-light"},s.a.createElement(u.b,{to:"/messages/"},s.a.createElement("i",{style:{cursor:"pointer"},className:"text-dark material-icons mr-2 d-lg-none"},"arrow_back")),s.a.createElement(u.b,{to:"/"+this.state.receiverData.uid,className:J.a.icon+" p-0 navbar-brand"},s.a.createElement("img",{src:this.state.isGroup?this.state.groupIcon:this.state.receiverData.profilePicture,alt:""})),this.state.receiverData.username?s.a.createElement("div",null,s.a.createElement("h1",{className:"text-dark mb-0 h5 text-capitalize",style:{lineHeight:"1"}},this.state.receiverData.username.substring(0,18)+(Array.from(this.state.receiverData.username).length>18?"...":"")),s.a.createElement("p",{style:{lineHeight:"1"},className:"text-dark m-0 font-weight-light"},"Active now")):s.a.createElement("h1",{className:"text-dark mb-0 h5 text-capitalize",style:{lineHeight:"1"}},this.props.match.params.chatId.substring(0,18)+(Array.from(this.props.match.params.chatId).length>18?"...":"")),s.a.createElement("div",{className:"collapse navbar-collapse"},s.a.createElement("ul",{className:"navbar-nav ml-auto"},s.a.createElement("li",{className:"nav-item"},s.a.createElement(u.b,{className:"nav-link py-0",to:""},s.a.createElement("i",{className:"material-icons"},"info")))))),s.a.createElement("div",{style:this.state.changeStyle?{marginBottom:"8.2rem",height:" calc(100% - 8.2rem)"}:null,className:J.a.chats,id:"scroll"},s.a.createElement("div",null,this.state.loading?null:s.a.createElement("div",{className:"py-5 "},s.a.createElement("div",{className:"mb-3 d-flex justify-content-center",style:{height:"8rem"}},this.state.isGroup?s.a.createElement("img",{src:this.state.groupIcon,className:"h-100 rounded-circle",alt:"",style:{width:"8rem ",objectFit:"cover"}}):s.a.createElement(s.a.Fragment,null,s.a.createElement("img",{src:this.state.senderData.profilePicture,className:"h-100 rounded-circle ",alt:"",style:{width:"8rem ",objectFit:"cover"}}),s.a.createElement("img",{src:this.state.receiverData.profilePicture,className:"h-100 rounded-circle",alt:"",style:{width:"8rem ",objectFit:"cover"}}))),s.a.createElement("h2",{className:"text-center h5"},"You and ",this.state.receiverData.username," are now friends")),this.state.chats.map((function(t,a){return e.state.isGroup?s.a.createElement(ee,{key:a,seen:t.seen,date:t.date,added:t.added,name:t.name,sender:t.sender,icon:t.profilePicture},t.message):s.a.createElement(Q,{key:a,seen:t.seen,date:t.date,added:t.added,sender:t.sender,icon:e.state.receiverData.profilePicture},t.message)})),this.state.loading?s.a.createElement("div",{className:"pb-3 mb-3"},s.a.createElement(S,{fontSize:"3px"})):null)),s.a.createElement(Z,{changeStyle:this.changeStyle,changed:this.inputChanged,value:this.state.value,sendChat:this.sendChats}))}}]),a}(n.Component),oe=Object(d.g)(le),ce=a(50),ie=a.n(ce),me=a(74),ue=a.n(me),de=a(58),he=a(23),pe=a.n(he),ge=a(75),fe=a.n(ge),ve=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={users:[],loading:!1,friends:[],username:"",profilePicture:"",icon:fe.a,uid:null,members:[],name:"",description:""},e.inputChange=function(t){e.setState({name:t.target.value})},e.descChange=function(t){e.setState({description:t.target.value})},e.getUsers=function(){e.setState({loading:!0}),D.database().ref("users/").on("value",(function(t){var a=[],n=t.val();for(var s in n){var r={};r.username=n[s].username,r.userId=s,r.profilePicture=n[s].profilePicture,a.push(r)}var l=Object(de.a)(e.state.friends),o=[];l.forEach((function(e){a.forEach((function(t,a){e.userId===t.userId&&o.push(a)}))}));for(var c=o.length-1;c>=0;c--)a[o[c]]=null;e.setState({users:a,loading:!1})}))},e.toggleMember=function(t,a){var n=Object(de.a)(e.state.members),s=null;t.currentTarget.children[0].children[2]?t.currentTarget.children[0].children[2].outerHTML="":t.currentTarget.children[0].innerHTML+='<i class="mr-3 text-success  ml-auto material-icons">check_circle</i>',n.forEach((function(e,t){e===a&&(s=t)})),null!==s?n.splice(s,1):n.push(a),e.setState({members:n})},e.createGroup=function(t){t.preventDefault();var a=D.database().ref("chats/"+e.state.name.toLocaleLowerCase());a.once("value",(function(t){t.val()?alert("Group name exists \n Pick another group name "):(a.child("chats/").push({message:e.state.username+" created the group",sender:"added",date:Date.now()}),D.database().ref("users/"+e.state.uid+"/chatsId").push(e.state.name),e.state.members.forEach((function(t){D.database().ref("users/"+t.userId).child("chatsId").push(e.state.name),a.child("metadata/"+t.userId).set({username:t.username,profilePicture:t.profilePicture}),a.child("chats/").push({message:e.state.username,added:t.username,sender:"added",date:Date.now()})})),a.child("metadata/"+e.state.uid).set({username:e.state.username,owner:!0,profilePicture:e.state.profilePicture}),a.child("icon").set(e.state.icon),a.child("description").set(e.state.description).then((function(t){e.props.history.push("/messages/"+e.state.name)})))}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.getUsers()}},{key:"componentDidUpdate",value:function(){this.state.uid!==this.props.uid&&(this.setState({uid:this.props.uid,username:this.props.username,profilePicture:this.props.profilePicture}),this.getFriends(this.props.uid))}},{key:"getFriends",value:function(e){var t=this;e&&(this.setState({loading:!0}),D.database().ref("users/"+e).on("value",(function(e){e.val().friendsId?function(){var a=[],n=function(t){D.database().ref("users/"+e.val().friendsId[t]).once("value",(function(n){var s={username:n.val().username,userId:e.val().friendsId[t],profilePicture:n.val().profilePicture};a.push(s)}))};for(var s in e.val().friendsId)n(s);t.setState({friends:a,loading:!1})}():t.setState({friends:[],loading:!1})})))}},{key:"render",value:function(){var e=this;return this.state.loading?s.a.createElement(S,null):s.a.createElement("div",{className:this.state.members.length>0&&!this.state.showForm?pe.a.pushed:null},this.state.showForm?s.a.createElement("form",{onSubmit:this.createGroup,className:"px-3 py-2"},s.a.createElement("div",{className:"d-flex pb-4 justify-content-between"},s.a.createElement("button",{type:"button",onClick:function(){e.setState({showForm:!1})},className:pe.a.next+" rounded-pill  btn btn-sm btn-outline-success"},"<-"," Back"),s.a.createElement("button",{className:pe.a.next+" rounded-pill  btn btn-sm btn-outline-success"}," Finish ->")),s.a.createElement("input",{onChange:this.inputChange,value:this.state.name,type:"text",placeholder:"Group name",style:{background:"#f7f7f7",border:"none",margin:" 0 0 1.5rem 0",width:"100%",padding:".5rem 1rem "},required:!0}),s.a.createElement("textarea",{onChange:this.descChange,value:this.state.description,style:{background:"#f7f7f7",border:"none",width:"100%",padding:".5rem 1rem "},rows:"3",placeholder:"Group description",required:!0}),s.a.createElement("h4",{className:"pt-4"},s.a.createElement("i",{className:"material-icons pr-3"},"people"),"Members ",this.state.members.length+1," "),s.a.createElement("div",{className:pe.a.horizontal+" pb-3 mt-2"},s.a.createElement("div",{className:"text-center pr-3"},s.a.createElement("img",{src:this.state.profilePicture,alt:"",style:{objectFit:"cover",background:"var(--light)",height:"4rem",width:"4rem"},className:"rounded-circle border "}),s.a.createElement("p",null,"You")),this.state.members.map((function(e){return s.a.createElement("div",{className:"text-center pr-3",key:e.userId},s.a.createElement("img",{src:e.profilePicture,alt:"",style:{objectFit:"cover",background:"var(--light)",height:"4rem",width:"4rem"},className:"rounded-circle border "}),s.a.createElement("p",null,e.username.substring(0,6)+(Array.from(e.username).length>6?"...":"")))})))):null,this.state.showForm?null:s.a.createElement(s.a.Fragment,null,this.state.members.length>0?s.a.createElement("div",{className:pe.a.fixed+" mb-3 px-3 border-bottom"},s.a.createElement("div",{className:"d-flex pb-2 justify-content-between align-items-center"},"  ",s.a.createElement("p",null,this.state.members.length," selected"),this.state.members.length>1?s.a.createElement("button",{onClick:function(){e.setState({showForm:!0})},className:pe.a.next+" rounded-pill  btn btn-sm btn-outline-success"},"Next ->"):null," "),s.a.createElement("div",{className:pe.a.horizontal},this.state.members.map((function(e){return s.a.createElement("div",{className:"text-center pr-3",key:e.userId},s.a.createElement("img",{src:e.profilePicture,alt:"",style:{objectFit:"cover",background:"var(--light)",height:"4rem",width:"4rem"},className:"rounded-circle border "}),s.a.createElement("p",null,e.username.substring(0,6)+(Array.from(e.username).length>6?"...":"")))})))):null,s.a.createElement("h5",{className:"px-3 d-flex align-items-center"},s.a.createElement("i",{className:"material-icons md-36 pr-2"},"group_add")," Add members "),s.a.createElement("h6",{className:"px-3"},"Friends"),this.state.friends.map((function(t,a){return s.a.createElement("div",{className:" text-dark px-3 py-1 d-block",key:t.userId,onClick:function(a){e.toggleMember(a,t)}},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-3"},s.a.createElement("img",{src:t.profilePicture,alt:"",style:{objectFit:"cover",background:"var(--light)",height:"4rem",width:"4rem"},className:"rounded-circle border "})),s.a.createElement("p",{className:"px-3"},t.username)))})),s.a.createElement("h6",{className:"px-3 mt-5"},"All users"),this.state.users.map((function(t,a){return t?s.a.createElement("div",{className:"text-dark px-3 py-1 d-block",key:t.userId,onClick:function(a){e.toggleMember(a,t)}},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-3"},s.a.createElement("img",{src:t.profilePicture,alt:"",style:{objectFit:"cover",background:"var(--light)",height:"4rem",width:"4rem"},className:"rounded-circle border "})),s.a.createElement("p",{className:"px-3"},t.username))):null}))," "))}}]),a}(n.Component),be=Object(d.g)(ve),Ee=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={chatData:{icon:"",onlineState:!0},userData:{username:"",chatroomBg:ie.a,uid:""},shouldLogout:!1,chatId:e.props.match.params.chatId,message:null,shouldShowChatroom:!1},e.getUserData=function(t){D.database().ref("users/"+t.uid).once("value",(function(a){var n=Object(v.a)({},e.state.userData,{uid:t.uid});for(var s in a.val())n[s]=a.val()[s];e.setState({userData:n})}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;D.auth().onAuthStateChanged((function(t){t?(e.setState({shouldLogout:!1}),e.getUserData(t)):e.setState({shouldLogout:!0})})),this.load(this.props.match.params.chatId),document.title="Skychat messenger";document.querySelector("meta[name=theme-color]");var t=localStorage.getItem("skychatTheme"),a=Object(v.a)({},this.state.userData);"dark"===t?(a.chatroomBg=ue.a,this.setState({userData:a})):(a.chatroomBg=ie.a,this.setState({userData:a}))}},{key:"componentDidUpdate",value:function(){this.props.match.params.chatId!==this.state.chatId&&(this.setState({chatId:this.props.match.params.chatId}),this.load(this.props.match.params.chatId))}},{key:"load",value:function(e){window.innerWidth>=1200||void 0!==e&&"new-group"!==e?this.setState({shouldShowChatroom:!0}):this.setState({shouldShowChatroom:!1})}},{key:"render",value:function(){var e=this;return this.state.shouldLogout?s.a.createElement(d.a,{to:"/login?messages"}):s.a.createElement("div",{className:E.a.Messages},s.a.createElement("div",{className:"container-fluid h-100 p-0"},s.a.createElement("div",{className:"row h-100 no-gutters"},s.a.createElement("div",{className:E.a.left+" col bg-white "},s.a.createElement("nav",{className:E.a.navbar+" bg-white navbar navbar-expand navbar-light"},s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/messages/new-group",render:function(){return s.a.createElement("i",{onClick:function(){e.props.history.push("/messages")},style:{cursor:"pointer"},className:"material-icons mr-2"},"arrow_back")}}),s.a.createElement(d.b,{path:"/messages",render:function(){return s.a.createElement("i",{onClick:function(){e.props.history.push("/menu")},style:{cursor:"pointer"},className:"material-icons mr-2"},"arrow_back")}})),s.a.createElement(u.b,{to:"/"+this.state.userData.uid,className:E.a.icon+" p-0 navbar-brand"},s.a.createElement("img",{src:this.state.userData.profilePicture,alt:""})),s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/messages/new-group",exact:!0,render:function(){return s.a.createElement("h3",{className:"mb-0"},"New group")}}),s.a.createElement(d.b,{path:"/messages",render:function(){return s.a.createElement("h3",{className:"mb-0"},"Chats")}})),s.a.createElement("div",{className:"collapse navbar-collapse"},s.a.createElement("ul",{className:"navbar-nav ml-auto"},s.a.createElement("li",{className:"nav-item"},s.a.createElement(u.b,{className:"nav-link",to:""},s.a.createElement("i",{className:"material-icons"},"settings")))))),s.a.createElement("div",{className:E.a.overflow+" h-100",style:{paddingTop:"3.6rem"}},s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/messages/new-group",render:function(){return s.a.createElement(be,{username:e.state.userData.username,profilePicture:e.state.userData.profilePicture,uid:e.state.userData.uid})}}),s.a.createElement(d.b,{path:"/messages",component:G})),s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/messages/new-group"}),s.a.createElement(d.b,{path:"/messages",render:function(){return s.a.createElement(u.b,{to:"/messages/new-group",className:E.a.bubble},s.a.createElement("i",{className:"material-icons"},"group_add"))}})))),this.state.shouldShowChatroom?s.a.createElement("div",{className:E.a.chatroom+" col",style:{backgroundImage:"url("+this.state.userData.chatroomBg+")"}},s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/messages/new-group",component:Y})," ",s.a.createElement(d.b,{path:"/messages/:chatId",render:function(){return s.a.createElement(oe,null)}}),s.a.createElement(d.b,{path:"/messages",component:Y}))):"")))}}]),a}(n.Component),ye=(a(46),a(12)),Ne=a.n(ye),ke=function(e){return s.a.createElement("div",{className:["alert-dismissible my-3 fade alert alert-"+e.type,e.show?"show":null].join(" "),role:"alert",style:{transition:"all 0.3s"}},s.a.createElement("button",{type:"button",className:"close","data-dismiss":"alert","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"),s.a.createElement("span",{className:"sr-only"},"Close")),e.children)},we=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={userData:{username:"",phoneNumber:""},loading:!1,message:null},n.updateName=function(e){e.preventDefault();var t=D.auth().currentUser;t.updateProfile({displayName:n.state.userData.username.toLowerCase()}).then((function(){var e=D.database().ref("users/"),a=t.uid;e.child(a+"/username").set(t.displayName.toLowerCase())}))},n.nameChanged=function(e){D.auth().currentUser;var t=Object(v.a)({},n.state.userData);t.username=e.target.value,n.setState({userData:t})},n.upload=function(e){var t=e,a=n.file.current;a.click(),a.onchange=function(e){var s=D.storage().ref("/"+n.state.userData.username.toLowerCase()),r=a.files[0],l=s.child("images/"+t).put(r);l.on(D.storage.TaskEvent.STATE_CHANGED,(function(e){n.setState({loading:!1});var t=e.bytesTransferred/e.totalBytes*100,a="Upload is "+Math.floor(t)+"% Done. ("+(e.totalBytes/1e6).toFixed(2)+" mb) ";switch(n.setState({progressMessage:a}),n.progBar.current.style.width=t+"%",e.state){case D.storage.TaskState.PAUSED:console.log("Upload is paused"),n.setState({progressMessage:"Upload is paused"});break;case D.storage.TaskState.RUNNING:}}),(function(e){switch(n.setState({loading:!1}),e.code){case"storage/unauthorized":n.setState({error:"You don't have permission to access the object"});break;case"storage/canceled":n.setState({error:"Upload canceled"});break;case"storage/unknown":n.setState({error:"Unknown error occurred"})}}),(function(){n.setState({loading:!0,progressMessage:null}),l.snapshot.ref.getDownloadURL().then((function(e){D.database().ref("users/"+n.state.userData.uid+"/"+t).set(e.replace(t,t+"_1024x1024")).then((function(e){n.setState({loading:!1})})).catch((function(e){n.setState({loading:!1,error:e})}));var a=D.auth().currentUser;"profilePicture"===t&&a.updateProfile({photoURL:e.replace(t,t+"_1024x1024")}).catch((function(e){this.setState({error:e})}))}))}))}},n.file=s.a.createRef(),n.progBar=s.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.title="Edit userdata | Skychat",this.setState({loading:!0}),D.auth().onAuthStateChanged((function(t){t&&D.database().ref("users/"+t.uid).on("value",(function(a){var n={username:a.val().username,uid:t.uid,profilePicture:a.val().profilePicture,coverPhoto:a.val().coverPhoto};e.setState({userData:n,loading:!1})}))}))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:Ne.a.pageBg},s.a.createElement("div",{className:"row no-gutters bg-white "+Ne.a.con},s.a.createElement("div",{className:Ne.a.cover+" col-12"},s.a.createElement("button",{className:Ne.a.btnBack,onClick:this.props.history.goBack},s.a.createElement("i",{className:"material-icons"},"arrow_back")),s.a.createElement("img",{alt:"",src:this.state.userData.coverPhoto}),s.a.createElement("input",{type:"file",accept:"image/*",className:"d-none",ref:this.file}),s.a.createElement("div",{className:Ne.a.profilePic},s.a.createElement("img",{alt:"",src:this.state.userData.profilePicture,className:" rounded-circle "}),s.a.createElement("i",{onClick:function(){e.upload("profilePicture")},className:"material-icons rounded-circle "},"camera_alt")),s.a.createElement("i",{onClick:function(){e.upload("coverPhoto")},className:"material-icons rounded-circle "},"camera_alt")),s.a.createElement("div",{style:{marginTop:"8rem"},className:"col-12 bg-light  "+Ne.a.coperate},this.state.error?s.a.createElement(ke,{type:"warning"},this.state.error):null,this.state.loading?s.a.createElement("div",{className:"py-5 bg-white"},s.a.createElement(S,{message:this.state.message,fontSize:"6px"})):this.state.progressMessage?s.a.createElement("div",{className:"row no-gutters pb-4 px-4 mb-2 bg-white"},s.a.createElement("h4",{className:"h5 font-weight-bold"},this.state.progressMessage),s.a.createElement("div",{className:Ne.a.progressBar},s.a.createElement("span",{ref:this.progBar}))):null,this.state.loading?null:s.a.createElement(s.a.Fragment,null,s.a.createElement("form",{className:"row no-gutters mb-2 bg-white",onSubmit:this.updateName},s.a.createElement("div",{className:"col-2 text-center text-primary"},s.a.createElement("i",{className:"material-icons "+Ne.a.icon},"person")),s.a.createElement("div",{className:"col-8"},s.a.createElement("h4",{className:"h6 font-weight-light"},"Username"),s.a.createElement("input",{type:"text",className:Ne.a.input+" h5 text-capitalize",onChange:this.nameChanged,value:this.state.userData.username})),s.a.createElement("div",{className:"col-2 text-center text-secondary"},s.a.createElement("button",{className:"btn btn-outline-dark btn-sm"},s.a.createElement("i",{className:"material-icons md-24"},"check")))),s.a.createElement("div",{className:"row no-gutters mb-2 bg-white"},s.a.createElement("div",{className:"col-2 text-center text-info"},s.a.createElement("i",{className:"material-icons "+Ne.a.icon},"phone")),s.a.createElement("div",{className:"col-8"},s.a.createElement("h4",{className:"h6 font-weight-light"},"Phone number"),s.a.createElement("h4",{className:"h5"},this.state.userData.phoneNumber?this.state.userData.phoneNumber:" + Add phone number")),s.a.createElement("div",{className:"col-2 text-center text-secondary"},s.a.createElement("i",{className:"material-icons md-24"},"edit"))),s.a.createElement("div",{className:"row no-gutters mb-2 bg-white"},s.a.createElement("div",{className:"col-2 text-center text-success"},s.a.createElement("i",{className:"material-icons "+Ne.a.icon},"home")),s.a.createElement("div",{className:"col-8"},s.a.createElement("h4",{className:"h6 font-weight-light"},"Home address"),s.a.createElement("h4",{className:"h5"},this.state.userData.address?this.state.userData.address:" + Add home address")),s.a.createElement("div",{className:"col-2 text-center text-secondary"},s.a.createElement("i",{className:"material-icons md-24"},"edit"))),s.a.createElement("div",{className:"row no-gutters mb-2 bg-white"},s.a.createElement("div",{className:"col-2 text-center text-warning"},s.a.createElement("i",{className:"material-icons "+Ne.a.icon},"face")),s.a.createElement("div",{className:"col-8"},s.a.createElement("h4",{className:"h6 font-weight-light"},"Gender"),s.a.createElement("h4",{className:"h5"},this.state.userData.gender?this.state.userData.gender:"Not set")),s.a.createElement("div",{className:"col-2 text-center text-secondary"},s.a.createElement("i",{className:"material-icons md-24"},"edit"))),s.a.createElement("div",{className:"row no-gutters mb-2 bg-white"},s.a.createElement("div",{className:"col-2 text-center text-danger"},s.a.createElement("i",{className:"material-icons "+Ne.a.icon},"cake")),s.a.createElement("div",{className:"col-8"},s.a.createElement("h4",{className:"h6    font-weight-light"},"Date of birth"),s.a.createElement("h4",{className:"h5"},this.state.userData.birthday?this.state.userData.birthday:"Not set")),s.a.createElement("div",{className:"col-2 text-center text-secondary"},s.a.createElement("i",{className:"material-icons md-24"},"edit")))))))}}]),a}(n.Component),Se=a(34),xe=a.n(Se),De=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={userData:null},e.checkUser=function(){D.auth().onAuthStateChanged((function(t){if(t){var a={username:t.displayName,profilePicture:t.photoURL};e.setState({userData:a}),e.props.history.push("/feed")}}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){document.title="Skychat homepage",this.checkUser()}},{key:"render",value:function(){return s.a.createElement("div",{className:xe.a.home,id:"page-top"},s.a.createElement("header",{className:xe.a.masthead},s.a.createElement("div",{className:"container h-100"},s.a.createElement("div",{className:"row h-100"},s.a.createElement("div",{className:"col-lg-7 my-auto"},this.state.userData?s.a.createElement("div",{className:" py-4 mx-auto d-flex text-light align-items-center justify-content-center"},s.a.createElement("img",{style:{height:"5rem",flexShrink:0,width:"5rem",objectFit:"cover"},src:this.state.userData.profilePicture,className:"bg-light rounded-circle ",alt:""}),s.a.createElement("div",{className:"text-light px-3 "},s.a.createElement("h4",{className:"text-light h6"},this.state.userData.username," is already logged in"),s.a.createElement(u.b,{to:"/"+this.state.userData.username,className:"btn btn-outline-light px-3 btn-sm  rounded-pill"},"Continue as ",this.state.userData.username))):null,s.a.createElement("div",{className:xe.a.header_content+" mx-auto"},s.a.createElement("h1",null,"Welcome to skychat"),s.a.createElement("img",{src:"logo.png"}),s.a.createElement("div",{className:xe.a.buttons},s.a.createElement(u.b,{style:{color:"white"},to:"/SignUp",className:"btn btn-warning px-5  rounded-pill"},"Sign up"),s.a.createElement(u.b,{to:"/login",className:"btn btn-light px-5  rounded-pill"},"Login "))))))))}}]),a}(n.Component),Ce=a(51),je=a.n(Ce),Ie=a(16),Me=a.n(Ie),Oe=Object(d.g)((function(e){var t=e.profile,a="navbar-light",n="l6",r="var(--white)",l=D.auth().currentUser;return t||l&&(t=l.uid),window.addEventListener("scroll",(function(){})),"/notifications"===e.location.pathname?(r="#f32",n="l6",a="navbar-dark"):(a="navbar-light",r="var(--white)",n="l1"),s.a.createElement(s.a.Fragment,null,s.a.createElement("nav",{style:{background:r},className:Me.a.Toolbar+"   navbar navbar-expand  fixed-top "+a},s.a.createElement("div",{className:"container-fluid h-100"},s.a.createElement(d.b,{path:"/menu/:nest",render:function(){return s.a.createElement("i",{style:{cursor:"pointer"},onClick:e.history.goBack,className:" material-icons px-3"},"arrow_back")}}),s.a.createElement(u.b,{to:"/",className:" navbar-brand align-items-center d-flex p-0 pb-1 pl-lg-3 h-100"},"dark"===localStorage.getItem("skychatTheme")?s.a.createElement(z,{type:"l5",width:"7rem"}):s.a.createElement(z,{type:n,width:"7rem"})),s.a.createElement("div",{className:"navbar-collapse collapse"},s.a.createElement("ul",{className:"text-capitalize navbar-nav ml-auto "},l?s.a.createElement(u.b,{className:"active ml-auto nav-link js-scroll-trigger",to:"/messages"},s.a.createElement("i",{className:"material-icons"},"chats")):"",s.a.createElement("div",{className:"d-none d-lg-inline-flex"},l?s.a.createElement("li",{className:"nav-item col-3 "},s.a.createElement(u.c,{activeClassName:Me.a.active,className:"nav-link js-scroll-trigger",to:"/feed"},s.a.createElement("i",{className:"material-icons"},"home"))):null,s.a.createElement("li",{className:"nav-item col-3 "},s.a.createElement(u.c,{activeClassName:Me.a.active,className:"nav-link js-scroll-trigger",to:"/"+t},s.a.createElement("i",{className:"material-icons"},"account_circle"))),l?s.a.createElement("li",{className:"nav-item col-3"},s.a.createElement(u.c,{activeClassName:Me.a.active,className:"nav-link js-scroll-trigger",to:"/notifications"},s.a.createElement("i",{className:"material-icons"},"notifications"))):"",l?s.a.createElement("li",{className:"nav-item col-3"},s.a.createElement(u.c,{activeClassName:Me.a.active,className:"nav-link js-scroll-trigger",to:"/menu"},s.a.createElement("i",{className:"material-icons"},"menu"))):""),l?"":s.a.createElement(u.b,{className:"ml-auto  nav-link js-scroll-trigger",to:"/login"},s.a.createElement("button",{style:{background:"orangered",color:"white"},className:"btn rounded-pill"},"Log in")))))),s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/",exact:!0}),s.a.createElement(d.b,{render:function(){return s.a.createElement("nav",{className:Me.a.Navbar+" fixed-bottom d-lg-none navbar navbar-expand navbar-light"},s.a.createElement("div",{className:"container-fluid navbar-collapse collapse p-0"},s.a.createElement("ul",{className:" navbar-nav w-100 text-center "},s.a.createElement("li",{className:"nav-item col-3 "},s.a.createElement(u.c,{activeClassName:Me.a.active,className:"nav-link js-scroll-trigger",to:"/feed"},s.a.createElement("i",{className:"material-icons"},"home"))),s.a.createElement("li",{className:"nav-item col-3 "},s.a.createElement(u.c,{activeClassName:Me.a.active,className:"nav-link js-scroll-trigger",to:"/"+t},s.a.createElement("i",{className:"material-icons"},"account_circle"))),t?s.a.createElement("li",{className:"nav-item col-3"},s.a.createElement(u.c,{activeClassName:Me.a.active,className:"nav-link js-scroll-trigger",to:"/notifications"},s.a.createElement("i",{className:"material-icons"},"notifications"))):"",t?s.a.createElement("li",{className:"nav-item col-3"},s.a.createElement(u.c,{activeClassName:Me.a.active,className:"nav-link js-scroll-trigger",to:"/menu"},s.a.createElement("i",{className:"material-icons"},"menu"))):"")))}})))})),Pe=a(35),Ue=a.n(Pe),Fe=a(26),Le=a.n(Fe),Te=a(52),Ae=a.n(Te),Re=a(76),qe=a.n(Re),Be=function(e){return e.show?s.a.createElement("div",{className:qe.a.Backdrop,onClick:e.clicked}):null},He=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return e.show!==this.props.show||e.children!==this.props.children}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(Be,{show:this.props.show,clicked:this.props.modalClosed}),s.a.createElement("div",{className:Ae.a.Modal,style:{transform:this.props.show?"translate(-50%, -50%)":"translate(-50% ,-100vh)",opacity:this.props.show?"1":"0"}},s.a.createElement("button",{className:Ae.a.cancel,onClick:this.props.modalClosed}," x "),this.props.children))}}]),a}(n.Component),_e=a(77),ze=a.n(_e),Ye=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={friendsData:[],loading:!1,uid:e.props.uid,toast:null},e.allFriends=function(){e.setState({showAllFriends:!0})},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.getFriends(this.props.uid)}},{key:"componentDidUpdate",value:function(){this.state.uid!==this.props.uid&&(this.setState({uid:this.props.uid}),this.getFriends(this.props.uid))}},{key:"getFriends",value:function(e){var t=this;e&&(this.setState({loading:!0}),D.database().ref("users/"+e).on("value",(function(e){e.val().friendsId?function(){var a=[],n=function(t){D.database().ref("users/"+e.val().friendsId[t]).once("value",(function(n){if(n.val()){var s={username:n.val().username,profilePicture:n.val().profilePicture,uid:e.val().friendsId[t]};a.push(s)}}))};for(var s in e.val().friendsId)n(s);t.setState({friendsData:a.reverse(),loading:!1}),console.log(a)}():t.setState({friendsData:[],loading:!1})})))}},{key:"render",value:function(){var e=this;return this.state.loading?s.a.createElement(S,{fontSize:"3px"}):this.props.uid?s.a.createElement("div",{className:"container-fluid p-0"},s.a.createElement(He,{show:this.state.showAllFriends,modalClosed:function(){return e.setState({showAllFriends:!1,seeMore:!1})}},s.a.createElement("div",{className:"d-flex  pb-3 align-items-center"},s.a.createElement("img",{className:Le.a.img,src:this.props.profilePicture,alt:""}),s.a.createElement("h4",{className:"h5 text-capitalize ml-4"},this.props.username,"'s Friends ",s.a.createElement("small",null,this.state.friendsData.length)," ")),this.state.friendsData.map((function(t,a){return e.state.seeMore?s.a.createElement(u.b,{to:"/"+t.uid,className:Le.a.friendList,key:t.username,onClick:function(){e.setState({showAllFriends:!1,seeMore:!1})}},s.a.createElement("img",{src:t.profilePicture,alt:""}),s.a.createElement("div",{style:{fontSize:" .9rem "},className:"text-dark px-2  py-1 card-body"},t.username)):a<2?s.a.createElement(u.b,{to:"/"+t.uid,className:Le.a.friendList,onClick:function(){e.setState({showAllFriends:!1,seeMore:!1})},key:t.username},s.a.createElement("img",{src:t.profilePicture,alt:""}),s.a.createElement("div",{style:{fontSize:" .9rem "},className:"text-dark px-2  py-1 card-body"},t.username)):null})),this.state.friendsData.length>2?s.a.createElement("button",{className:"rounded-pill d-flex mx-auto my-3 btn btn-sm btn-outline-primary",onClick:function(){e.setState({seeMore:!e.state.seeMore})}},this.state.seeMore?"See less":"See more ->"):null),this.state.toast?s.a.createElement(f,null,this.state.toast):null,s.a.createElement("div",{className:"row bg-white border-bottom no-gutters"},s.a.createElement("div",{className:"col-12 px-3 d-flex align-items-center"},s.a.createElement("i",{className:"material-icons md-36 pr-2"},"perm_identity"),s.a.createElement("h4",{className:"mb-0"},"Friends"," ",s.a.createElement("span",{className:"pl-2 font-weight-light"},this.state.friendsData.length))),s.a.createElement("div",{className:"col-12 px-3"},s.a.createElement("div",{className:Le.a.horizontal_scroll+" row no-gutters "},this.state.friendsData.map((function(e,t){return t<3?s.a.createElement("div",{className:"col-4 col-lg-3 px-1",key:t},s.a.createElement(u.b,{to:"/"+e.uid,className:Le.a.friendCard},s.a.createElement("img",{src:e.profilePicture,alt:""}),s.a.createElement("div",{style:{fontSize:" .9rem "},className:"text-dark px-2  py-1 card-body"},e.username))):null})),s.a.createElement("div",{className:"col-4 col-lg-3 px-1"},s.a.createElement("button",{onClick:this.allFriends,className:Le.a.friendCard},s.a.createElement("img",{alt:"",src:ze.a}),s.a.createElement("div",{style:{fontSize:" .9rem "},className:"text-dark px-2  py-1 card-body"},"See all friends"))))))):null}}]),a}(n.Component),Ge=a(30),We=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={loading:!1,allUsers:null,toast:null,request:[]},e.sendRequest=function(t,a){D.database().ref("/users/"+t+"/requestsId").push(e.props.userData.uid).then((function(t){e.setState({toast:null}),e.setState({toast:"Request sent"})})).catch((function(t){e.setState({toast:"Request  notsent"})}))},e.getRequest=function(){D.database().ref("users/"+e.props.userData.uid+"/requestsId").on("value",(function(t){var a=[];for(var n in t.val())a.push({friendId:t.val()[n],requestId:n});var s=[];a.forEach((function(e){D.database().ref("users/"+e.friendId).on("value",(function(t){var a={username:t.val().username,profilePicture:t.val().profilePicture,uid:e.friendId,reqId:e.requestId};s.push(a)}))})),e.setState({request:s})}))},e.acceptRequest=function(t,a,n,s,r){var l,o=D.database().ref("users/"+t),c=D.database().ref("users/"+e.props.userData.uid),i=e.props.userData.username+"&"+a,m=D.database().ref("chats/"+i);o.child("friendsId").push(e.props.userData.uid),o.child("chatsId").push(i),c.child("friendsId").push(t),c.child("chatsId").push(i),m.set({metadata:(l={},Object(Ge.a)(l,e.props.userData.uid,{profilePicture:e.props.userData.profilePicture,username:e.props.userData.username}),Object(Ge.a)(l,t,{profilePicture:n,username:a}),l)}).then((function(t){m.child("chats/").push({message:"You are now connected together. Enjoy messaging in the cloud ",sender:"skymail",date:Date.now()});var a=e.state.request;a.splice(s,1),e.setState({request:a})}));var u={};return u["/users/"+e.props.userData.uid+"/requestsId/"+r]=null,u["/users/"+t+"/requestsId/"+r]=null,D.database().ref().update(u)},e.declineRequest=function(t,a){var n={};return n["/users/"+e.props.userData.uid+"/requestsId/"+a]=null,n["/users/"+t+"/requestsId/"+a]=null,D.database().ref().update(n)},e.cancelRequest=function(t){D.database().ref("/users/"+t+"/requestsId").on("value",(function(a){for(var n in a.val())a.val()[n]===e.props.userData.uid&&D.database().ref("/users/"+t+"/requestsId/"+n).remove().then((function(){e.setState({toast:null}),e.setState({toast:"Request canceled"})}))}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.getRequest(),this.getAllUsers()}},{key:"getAllUsers",value:function(){var e=this;this.setState({loading:!0}),D.database().ref("users/").on("value",(function(t){var a=[];if(e.props.userData.uid){var n=t.val()[e.props.userData.uid].friendsId,s=[];if(n)for(var r in n)s.push(n[r]);for(var l in t.val())if(t.val()[l].username!==e.props.userData.username){var o={username:t.val()[l].username,profilePicture:t.val()[l].profilePicture,uid:l},c=t.val()[l].requestsId;for(var i in c)c[i]===e.props.userData.uid&&(o={username:t.val()[l].username,profilePicture:t.val()[l].profilePicture,uid:l,sent:!0});a.push(o)}var m=[];s.forEach((function(e){a.forEach((function(t,a){e===t.uid&&m.push(a)}))}));for(var u=m.length-1;u>=0;u--)a[m[u]]=null;e.setState({loading:!1,allUsers:a})}}))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"container-fluid p-0"},this.state.toast?s.a.createElement(f,null,this.state.toast):null,s.a.createElement("div",{className:"border-bottom row no-gutters bg-white py-3"},s.a.createElement("h1",{className:"col-12 px-3  h4"},"You have ",this.state.request.length," Friend request",s.a.createElement("small",null,"(s)")," "),this.props.hideReq?null:this.state.request.map((function(t,a){return s.a.createElement("div",{className:"row align-items-center py-2 px-3 no-gutters ",key:t.uid},s.a.createElement("div",{className:"col-3 col-md-2"},s.a.createElement("img",{src:t.profilePicture,alt:"",style:{height:"3.5rem",width:"3.5rem",objectFit:"cover"},className:" rounded-circle border"})),s.a.createElement("div",{className:"col-9 pl-4"},s.a.createElement("h5",{className:"text-capitalize h6 font-weight-bold"},t.username),s.a.createElement("div",{className:"d-flex "},s.a.createElement("button",{onClick:function(){e.declineRequest(t.uid,t.reqId)},className:"btn-sm px-3 btn btn-red"},"Decline"),s.a.createElement("button",{onClick:function(){e.acceptRequest(t.uid,t.username,t.profilePicture,a,t.reqId)},className:"btn-sm btn btn-outline-warning ml-3 px-5"},"Accept"))))}))),this.props.hideAll?null:s.a.createElement("div",{className:"border-bottom row no-gutters bg-light py-5"},s.a.createElement("h3",{className:"col-12 pl-3 h5"}," Find new friends to fly with"),s.a.createElement("div",{className:"col-12 px-3"},s.a.createElement(M,null)),s.a.createElement("div",{className:"col-12 pt-4"},this.state.allUsers?this.state.allUsers.map((function(t,a){return t?s.a.createElement("div",{className:"row align-items-center py-2 px-3 no-gutters ",key:a},s.a.createElement("div",{className:"col-2 col-md-1",onClick:function(){e.props.history.push("/"+t.uid)}},s.a.createElement("img",{src:t.profilePicture,alt:"",style:{height:"3.5rem",width:"3.5rem",objectFit:"cover"},className:"rounded-circle border"})),s.a.createElement("div",{className:"col pl-4"},s.a.createElement("h5",{className:"text-capitalize h6 font-weight-bold"},t.username),s.a.createElement("div",null,t.sent?s.a.createElement("button",{onClick:function(){e.cancelRequest(t.uid)},className:"btn btn btn-red"},"X ",s.a.createElement("span",{className:"pl-3"}," Cancel Request")):s.a.createElement("button",{onClick:function(){e.sendRequest(t.uid,a)},className:"btn btn btn-outline-success"},"+ ",s.a.createElement("span",{className:"pl-4"},"Add friend"))))):null})):s.a.createElement(S,{fontSize:"4px"}))))}}]),a}(n.Component),Je=Object(d.g)(We),Ke=a(59),Ve=a(11),Ze=a.n(Ve),Xe=function(e){var t,a="Dec 12 2019 at 5:30pm",r=new Date(e.date),l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Sep","Oct","Nov","Dec"][r.getMonth()],o=r.getFullYear(),c=r.getDate(),i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][r.getDay()],m=r.getHours(),d=(t=r.getMinutes())<10?"0"+t:t,h=(r.getTime()," am");m>12&&(h=" pm",m-=12);var p=new Date;a=p.getDate()===c?"Today at "+m+":"+d+h:p.getDate()-c===1||p.getDate()-c===-30?"Yesterday at "+m+":"+d+h:p.getDate()-c>1&&p.getDate()-c<7?i+" at "+m+":"+d+h:o===p.getFullYear()?l+" "+c+" at "+c+" "+m+":"+d+h:o>p.getFullYear()?l+" "+c+" "+o+" at "+m+":"+d+h:i+"  "+m+":"+d+h;var g=Object(n.useState)(!1),f=Object(Ke.a)(g,2),v=f[0],b=f[1],E=[];if(e.likes)for(var y in e.likes)D.database().ref("users/"+y).on("value",(function(e){var t=e.val();E.push(t)}));var N=E[E.length-1],k=s.a.createRef();window.addEventListener("scroll",(function(){var e=k.current;null!==e&&(e.getBoundingClientRect().top<=300&&e.getBoundingClientRect().top>0?e.play():e.pause())}));var w=Object(n.useState)(""),S=Object(Ke.a)(w,2),x=S[0],C=S[1];return s.a.createElement("div",{className:Ze.a.Post+" mb-3 bg-white"},s.a.createElement("div",{className:"d-flex align-items-center px-3 py-2"},s.a.createElement(u.b,{to:"/"+e.uid},s.a.createElement("img",{src:e.icon,alt:"",className:Ze.a.icon+" border rounded-circle"})),s.a.createElement("div",{className:"px-3"},s.a.createElement("h4",{className:Ze.a.coprate+" h6"},e.username),s.a.createElement("p",{className:Ze.a.date},a)),s.a.createElement("i",{className:Ze.a.moreCon+" material-icons ml-auto"},"more_vert"),s.a.createElement("div",{className:Ze.a.more},e.isMine?s.a.createElement("button",{onClick:e.deletePost},"Delete post"):null)),e.title?s.a.createElement("h1",{className:Ze.a.title+" h3 px-4 py-2 "},e.title):null,e.body?s.a.createElement("p",{className:"px-3 pb-2",dangerouslySetInnerHTML:{__html:e.body}}):null,e.type?s.a.createElement("div",{className:Ze.a.con},"images"===e.type?s.a.createElement("img",{alt:"",src:e.src,className:"border-0"}):null,"video"===e.type?s.a.createElement("video",{ref:k,controls:!0,loop:!0,src:e.src}):null):null,s.a.createElement("form",{onSubmit:function(t){C(""),b(!1),e.postComment(t,x)},className:Ze.a.btnCon+"  d-flex align-items-center px-2 "},s.a.createElement("input",{onBlur:function(){x||b(!1)},onFocus:function(){b(!0)},type:"text",placeholder:"Comment.....",className:Ze.a.comment,value:x,onChange:function(e){C(e.target.value)},required:!0}),v?s.a.createElement("button",{className:Ze.a.btn,type:"submit"},s.a.createElement("i",{className:"material-icons "},"chat_bubble_outline")):s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{type:"button",style:{color:e.liked?"red":null},className:Ze.a.btn,onClick:function(){var t=D.database().ref("posts/"+e.id+"/likes/"+e.likeeId);e.liked?t.set(null).then((function(){})):t.set(Date.now()).then((function(){}))}},s.a.createElement("i",{className:"material-icons "},e.liked?"favorite":"favorite_border")),s.a.createElement("button",{type:"button",className:Ze.a.btn},s.a.createElement("i",{className:"material-icons "},"share")))),s.a.createElement("div",{className:"d-flex px-3  align-items-center "},N?s.a.createElement("span",{className:""},"Liked by  ",s.a.createElement("strong",{className:"text-capitalize px-1"}," ",N.username," "),"  ",E.length-1>0?s.a.createElement(s.a.Fragment,null,"and ",s.a.createElement("strong",{className:" px-1"}," ",E.length-1," ")," other(s)"):null):null),e.comments?s.a.createElement("div",{className:" px-3 pb-2 "},s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{className:"pb-3 d-block"},e.comments.length," comment((s))"),e.comments.map((function(e){return s.a.createElement("div",{className:Ze.a.comments_box,key:e.comment+e.uid},s.a.createElement("img",{src:e.profilePicture,alt:""}),s.a.createElement("div",null,s.a.createElement("h5",{className:"text-capitalize"},e.username),s.a.createElement("p",null,e.comment)))})))):null)},$e=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={posts:[],loading:!1},e.deletePost=function(e,t){t?(D.storage().ref(t).delete(),D.database().ref("posts/"+e).set(null)):D.database().ref("posts/"+e).set(null)},e.getPosts=function(t){e.setState({loading:!0}),D.database().ref("posts/").orderByChild("uid").equalTo(t).on("value",(function(t){var a=[],n=function(n){D.database().ref("users/"+t.val()[n].uid).on("value",(function(s){var r={title:t.val()[n].title,body:t.val()[n].body,id:n,icon:s.val().profilePicture,username:s.val().username,date:t.val()[n].date,type:t.val()[n].type,uid:t.val()[n].uid,liked:!1,storageRef:t.val()[n].storageRef,likes:t.val()[n].likes,src:t.val()[n].src};if(t.val()[n].uid===e.props.likeeId&&(r.isMine=!0),t.val()[n].comments){var l=[];for(var o in t.val()[n].comments)l.push(t.val()[n].comments[o]);r.comments=l.reverse()}r.likes&&r.likes[e.props.likeeId]&&(r.liked=!0),a.push(r)}))};for(var s in t.val())n(s);e.setState({posts:a.reverse(),loading:!1})}))},e.postComment=function(t,a,n){t.preventDefault(),console.log("post",a,n),D.database().ref("users/"+e.props.likeeId).once("value",(function(t){var s={username:t.val().username,profilePicture:t.val().profilePicture,uid:e.props.likeeId,date:Date.now(),comment:a};D.database().ref("posts/"+n+"/comments").push(s).then((function(){re("success")}))}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){D.auth().currentUser;this.getPosts(this.props.uid)}},{key:"componentDidUpdate",value:function(){this.state.uid!==this.props.uid&&(this.setState({uid:this.props.uid}),this.getPosts(this.props.uid))}},{key:"render",value:function(){var e=this;return this.state.loading?s.a.createElement("div",{style:{height:"5rem"}},s.a.createElement(S,{fontSize:"3px"})):s.a.createElement("div",{className:"pt-2 "},this.state.toast?s.a.createElement(f,{message:this.setState.toast}):null,s.a.createElement("h4",{className:"pl-4 py-3 bg-white m-0"},"Posts ",s.a.createElement("small",null,this.state.posts.length)," "),this.state.posts.map((function(t){return s.a.createElement(Xe,Object.assign({},t,{key:t.id,postComment:function(a,n){e.postComment(a,n,t.id)},deletePost:function(){e.deletePost(t.id,t.storageRef)},likeeId:e.props.likeeId}))})),s.a.createElement("p",{className:"text-center"},"No more posts "))}}]),a}(n.Component),Qe=a(36),et=a.n(Qe),tt=function(e){var t=s.a.createRef(),a=s.a.createRef();return s.a.createElement("form",{autoComplete:"off",onSubmit:e.sendPost,className:et.a.msgInput+" mt-2 row no-gutters"},s.a.createElement("div",{className:"col-12"},s.a.createElement("h5",null," + Add new post")),s.a.createElement("div",{className:"col-md-11 col-10"},s.a.createElement("input",{id:"newPostTitle",ref:t,onFocus:function(){a.current.style.display="flex"},rows:"1",type:"text",onChange:e.titleChanged,value:e.title,placeholder:"Write a post"}),s.a.createElement("textarea",{id:"newPostBody",ref:a,onInput:function(e){a.current.style.height=a.current.scrollHeight+1+"px"},style:{display:"none"},rows:"1",type:"text",onChange:e.bodyChanged,value:e.body,placeholder:"Post body...."})),s.a.createElement("div",{className:"col-md-1 col-2 pb-1  d-flex align-items-center",style:{alignSelf:"flex-start"}},s.a.createElement("button",{className:"w-100 p-0 d-flex align-items-center",style:{border:0,outline:0,background:"none"}},s.a.createElement("i",{className:"material-icons h-100 mx-auto",style:{fontSize:"2.5rem",lineHeight:"1",color:"orangered"}},"send"))),e.src?s.a.createElement("div",{className:et.a.media+" col-12 d-flex mt-3 justify-content-around"},"video"===e.type?s.a.createElement("video",{src:e.src,autoPlay:!0,loop:!0}," "):"images"===e.type?s.a.createElement("img",{src:e.src,alt:""}):null):null,s.a.createElement("div",{className:"col-12 d-flex mt-3 justify-content-around"},s.a.createElement("button",{type:"button",onClick:function(){return e.upload("images")},className:et.a.btn},s.a.createElement("i",{className:"material-icons text-success pr-2"},"photo"),"Photo"),s.a.createElement("button",{type:"button",onClick:function(){return e.upload("video")},className:et.a.btn},s.a.createElement("i",{className:"material-icons text-danger pr-2"},"videocam"),"Video")))},at=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={profileData:{username:"",coverPhoto:"",uid:null},isUser:!1,loading:!1,profile:"",errorMessage:null,changeStyle:!1,showPostForm:!0,modalMessage:null,postTitle:"",postBody:"",type:null,src:null},n.titleChanged=function(e){n.setState({postTitle:e.target.value})},n.bodyChanged=function(e){n.setState({postBody:e.target.value})},n.sendPost=function(e){n.setState({play:null}),e.preventDefault();var t={title:n.state.postTitle,icon:n.state.profileData.profilePicture,username:n.state.profileData.username,body:n.state.postBody.split("\n").join("<br/>"),type:n.state.type,src:n.state.src,storageRef:"/"+n.props.userData.username.toLowerCase()+"/"+n.state.type+"/"+n.state.sref,date:Date.now(),uid:n.state.profileData.uid};t.title||t.body||t.src?(D.database().ref("posts/").push(t).then((function(e){n.setState({src:null,type:null}),re("success")})),n.setState({postBody:"",postTitle:""})):n.setState({error:"Type something or pick an image/video to post"})},n.upload=function(e){n.setState({showPostForm:!1,error:null});var t=document.createElement("input");t.type="file","images"===e?t.setAttribute("accept","image/*"):t.setAttribute("accept","video/*"),t.click(),t.onchange=function(a){var s=D.storage().ref("/"+n.props.userData.username.toLowerCase()),r=t.files[0];if(r.size>1e7)n.setState({showPostForm:!0,error:"File too large \n Maximum size is 10mb"});else{var l=s.child(e+"/"+r.name).put(r);l.on(D.storage.TaskEvent.STATE_CHANGED,(function(e){n.setState({showPostForm:!1});var t=e.bytesTransferred/e.totalBytes*100,a="Upload is "+Math.floor(t)+"% Done. ("+(e.totalBytes/1e6).toFixed(2)+" mb) ";switch(n.setState({progressMessage:a}),n.progBar.current.style.width=t+"%",e.state){case D.storage.TaskState.PAUSED:console.log("Upload is paused"),n.setState({progressMessage:"Upload is paused"});break;case D.storage.TaskState.RUNNING:}}),(function(e){switch(n.setState({showPostForm:!0}),e.code){case"storage/unauthorized":n.setState({error:"You don't have permission to access the object"});break;case"storage/canceled":n.setState({error:"Upload canceled"});break;case"storage/unknown":default:n.setState({error:"Unknown error occurred"})}}),(function(){(n.setState({showPostForm:!1,progressMessage:null}),"images"===e)?l.snapshot.ref.getDownloadURL().then((function(t){var a=t.replace(r.name,r.name.split(".").join("_1024x1024."));console.log(a),setTimeout((function(){n.setState({showPostForm:!0,type:e,progressMessage:null,src:a,sref:r.name.split(".").join("_1024x1024.")})}),2e3)})):l.snapshot.ref.getDownloadURL().then((function(t){n.setState({showPostForm:!0,type:e,progressMessage:null,src:t,sref:r.name})}))}))}}},n.load=function(e){document.documentElement.scrollTop=0,n.setState({loading:!0});var t=!1,a=D.database().ref("users/");e&&a.child(e).on("value",(function(a){var r=Object(v.a)({},n.state.profileData);for(var l in a.val())r[l]=a.val()[l],r.uid=e;n.setState({profileData:r}),setTimeout((function(e){n.setState({loading:!1})}),1e3),r.username&&(t=!0),r.username===n.props.userData.username?n.setState({isUser:!0}):n.setState({isUser:!1}),t||n.setState({errorMessage:s.a.createElement("span",null,"User ",s.a.createElement("strong",{className:"text-capitalize"},r.username)," not found")})}))},n.progBar=s.a.createRef(),n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.load(this.props.profile);var e=localStorage.getItem("skychatTheme"),t=document.querySelector("meta[name=theme-color]");"dark"===e?t.setAttribute("content"," #171e25"):"light"===e&&t.setAttribute("content"," #fff")}},{key:"componentDidUpdate",value:function(){this.props.match.params.profile!==this.state.profile&&(this.setState({profile:this.props.match.params.profile}),this.load(this.props.match.params.profile))}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,this.state.errorMessage?s.a.createElement(ke,{type:"danger",show:!0},this.state.errorMessage," "):null,s.a.createElement("div",{className:"container "},s.a.createElement("div",{className:"row "},s.a.createElement("div",{className:"col-md-8 col-lg-7 p-0 order-md-2 px-lg-3"},s.a.createElement("div",{className:"row no-gutters bg-white"},s.a.createElement("div",{className:Ue.a.cover+" col "},s.a.createElement("img",{src:this.state.profileData.coverPhoto,alt:""}),s.a.createElement("div",{className:Ue.a.dp},s.a.createElement("img",{src:this.state.profileData.profilePicture,alt:""})),this.state.loading?s.a.createElement(S,{style:{background:"var(--secondary)"}}):s.a.createElement("h3",{className:Ue.a.username},this.state.isUser?s.a.createElement("span",null,this.state.profileData.username," ",s.a.createElement("small",null,"(You)")):this.state.profileData.username))),this.state.isUser?s.a.createElement("div",{className:"bg-white  text-center"}," ",s.a.createElement(u.b,{to:"/edit-profile",className:"btn  btn-outline-dark rounded-pill px-5 mx-auto btn-sm"},"Edit profile")):null,s.a.createElement(Ye,this.state.profileData),this.state.isUser?s.a.createElement(Je,{hideAll:!0,userData:this.props.userData}):null,this.state.isUser?this.state.progressMessage?null:this.state.showPostForm?s.a.createElement(tt,{titleChanged:this.titleChanged,bodyChanged:this.bodyChanged,title:this.state.postTitle,upload:this.upload,src:this.state.src,type:this.state.type,body:this.state.postBody,sendPost:this.sendPost}):s.a.createElement("div",{style:{height:"10rem"},className:"bg-white"}," ",s.a.createElement(S,{fontSize:"8px"})," "):null,this.state.error?s.a.createElement(ke,{type:"warning",show:!0},this.state.error):null,this.state.progressMessage?s.a.createElement("div",{className:"row no-gutters pb-4 px-4 mb-2 bg-white"},s.a.createElement("h4",{className:"h5 font-weight-bold"},this.state.progressMessage),s.a.createElement("div",{className:Ue.a.progressBar},s.a.createElement("span",{ref:this.progBar}))):null,this.state.profileData.uid?s.a.createElement($e,{uid:this.state.profileData.uid,likeeId:this.props.userData.uid}):null),s.a.createElement("div",{className:"col-md-4 col-lg-2 order-md-1 bg-white "},s.a.createElement("div",{className:"row no-gutters"},s.a.createElement("div",{className:" col "}))),s.a.createElement("div",{className:"col-lg-3 order-md-3 bg-white "},s.a.createElement("div",{className:"row no-gutters"},s.a.createElement("div",{className:" col "}))))))}}]),a}(n.Component),nt=Object(d.g)(at),st=a(53),rt=a.n(st),lt=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={nots:[{icon:T.a,title:"Welcome to Skychat by king hoddy",description:"Created by odunmilade",button:null,link:"",seen:!1}]},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){document.querySelector("meta[name=theme-color]").setAttribute("content","#f32")}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(Je,{hideAll:!0,userData:this.props.userData}),this.state.nots.map((function(e){return s.a.createElement(u.b,{to:"/messages/"+e.link,className:rt.a.nots+" px-3 py-2 text-capitalize  border-bottom d-flex align-items-center"+(e.seen," bg-dark "),key:e.link},s.a.createElement("div",{className:rt.a.picture},s.a.createElement("img",{src:e.icon,alt:"chat Icon"})),s.a.createElement("div",{style:{minWidth:"11rem"},className:"ml-3 text-dark  "},s.a.createElement("h3",{className:" font-weight-bold h5 m-0"},e.title?e.title.split("<br/>").join(" ").substring(0,20)+(Array.from(e.title).length>20?"...":""):null),s.a.createElement("p",{className:"m-0"},e.description?e.description.split("<br/>").join(" ").substring(0,21)+(Array.from(e.description).length>21?" ...":""):null)),s.a.createElement("div",{className:"text-right ml-auto"},s.a.createElement("h6",{style:{color:"#888"}},e.time)))})))}}]),a}(n.Component),ot=a(27),ct=a.n(ot),it=a(54),mt=a.n(it),ut=function(e){var t=':root { --blue: #007bff; --indigo: #6610f2; --purple: #6f42c1; --pink: #e83e8c; --red: #dc3545; --orange: #fd7e14; --yellow: #ffc107; --green: #28a745; --teal: #20c997; --cyan: #17a2b8; --white: #fff; --gray: #eee; --black: #000; --gray-dark: #777; --primary: #007bff; --secondary: #ddd; --success: #28a745; --info: #17a2b8; --warning: #ffc107; --danger: #dc3545; --light: #f9f9f9; --dark: #343a40; --breakpoint-xs: 0; --breakpoint-sm: 576px; --breakpoint-md: 768px; --breakpoint-lg: 992px; --breakpoint-xl: 1200px; --font-family-sans-serif: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; --font-family-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }',a=':root { --blue: #007bff; --indigo: #6610f2; --purple: #6f42c1; --pink: #e83e8c; --red: #fbeaec; --orange: #fd7e14; --yellow: #ffc107; --green: #28a745; --teal: #20c997; --cyan: #17a2b8; --white: #171e25; --gray: #101010; --gray-dark: #aaa; --primary: #007bff; --secondary: #777; --success: #28a745; --info: #17a2b8; --warning: #ffc107; --danger: #dc3545; --light: #11161b; --dark: #f7f7f7; --black: #fff; --breakpoint-xs: 0; --breakpoint-sm: 576px; --breakpoint-md: 768px; --breakpoint-lg: 992px; --breakpoint-xl: 1200px; --font-family-sans-serif: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; --font-family-monospace: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }',n=localStorage.getItem("skychatTheme"),r=t;null===n?localStorage.setItem("skychatTheme","light"):"dark"===n&&(r=a),console.log(n);var l=document.getElementById("style");return l.innerHTML=r,s.a.createElement("div",{className:"bg-white p-4"},s.a.createElement("h4",null,"Theme"),s.a.createElement("div",{className:"d-flex"},s.a.createElement("div",{onClick:function(){localStorage.setItem("skychatTheme","light"),l.innerHTML=t},className:mt.a.theme}),s.a.createElement("div",{onClick:function(){localStorage.setItem("skychatTheme","dark"),l.innerHTML=a},className:mt.a.theme+" mx-3"})))},dt=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={loading:!1,shouldLogout:!1,userData:{profilePicture:"",username:"",uid:""}},e.logOutHandler=function(){e.setState({loading:!0}),D.auth().signOut().then((function(){e.setState({loading:!1,shouldLogout:!0})})).catch((function(t){e.setState({loading:!1}),console.log(t)}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;D.auth().onAuthStateChanged((function(t){if(e.setState({loading:!0}),t){var a=Object(v.a)({},e.state.userData);a.profilePicture=t.photoURL,a.uid=t.uid,a.username=t.displayName.toLowerCase(),document.title=t.displayName+" Skychat | Menu"+e.setState({loading:!1,shouldLogout:!1,userData:a})}else e.setState({shouldLogout:!0,loading:!1})}))}},{key:"render",value:function(){var e=this,t=s.a.createElement(s.a.Fragment,null,s.a.createElement(u.b,{to:"/edit-profile",className:ct.a.MenuLink+" row no-gutters"},s.a.createElement("div",{className:"col-2 col-md-1 text-success"},s.a.createElement("i",{className:"material-icons"},"edit")),s.a.createElement("div",{className:"col d-flex justify-content-between align-items-center"},"Edit profile",s.a.createElement("img",{src:this.state.userData.profilePicture,className:" rounded-circle",alt:""}))),s.a.createElement(u.b,{to:"/menu/friends",className:ct.a.MenuLink+" row no-gutters"},s.a.createElement("div",{className:"col-2 col-md-1 text-primary"},s.a.createElement("i",{className:"material-icons"},"people")),s.a.createElement("div",{className:"col"},"Friends")),s.a.createElement(u.b,{to:"menu/display-settings",className:ct.a.MenuLink+" row no-gutters"},s.a.createElement("div",{className:"col-2 col-md-1 text-warning"},s.a.createElement("i",{className:"material-icons"},"brightness_medium")),"Display"),s.a.createElement(u.b,{to:"/",className:ct.a.MenuLink+" row no-gutters"},s.a.createElement("div",{className:"col-2 col-md-1 text-info"},s.a.createElement("i",{className:"material-icons"},"help")),"Help amd feedback"),s.a.createElement(u.b,{to:"/login",onClick:this.logOutHandler,className:ct.a.MenuLink+" row no-gutters"},s.a.createElement("div",{className:"col-2 col-md-1 text-danger"},s.a.createElement("i",{className:"fa fa-door-open"})),"Log out"));return this.state.shouldLogout&&(t=s.a.createElement(d.a,{to:"/login?menu"})),this.state.loading?s.a.createElement(S,null):s.a.createElement("div",{className:"row no-gutters justify-content-center"},s.a.createElement("div",{className:"col-lg-6 py-lg-4"},s.a.createElement(d.b,{exact:!0,path:"/menu",render:function(){return s.a.createElement(s.a.Fragment,null,t)}}),s.a.createElement(d.b,{exact:!0,path:"/menu/display-settings",render:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(ut,null))}}),s.a.createElement(d.b,{exact:!0,path:"/menu/friends",render:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(Ye,{uid:e.state.userData.uid}),s.a.createElement(Je,{userData:e.state.userData}))}})))}}]),a}(n.Component),ht=a(55),pt=a.n(ht),gt=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={loading:!1,userData:{},posts:[]},e.deletePost=function(e,t){t?(D.storage().ref(t).delete(),D.database().ref("posts/"+e).set(null)):D.database().ref("posts/"+e).set(null)},e.getPosts=function(){document.documentElement.scrollTop=0,e.setState({loading:!0});var t=D.database().ref("users/");t.child(e.props.uid).on("value",(function(a){var n=a.val().friendsId,s=[e.props.uid];for(var r in n)s.push(n[r]);D.database().ref("posts/").on("value",(function(a){var n=[],r=function(r){s.forEach((function(s){if(a.val()[r].uid===s){var l={title:a.val()[r].title,body:a.val()[r].body,id:r,icon:a.val()[r].icon,username:a.val()[r].username,date:a.val()[r].date,type:a.val()[r].type,liked:!1,uid:a.val()[r].uid,storageRef:a.val()[r].storageRef,likes:a.val()[r].likes,src:a.val()[r].src};if(t.child(a.val()[r].uid).once("value",(function(e){l.icon=e.val().profilePicture,l.username=e.val().username})),a.val()[r].uid===e.props.uid&&(l.isMine=!0),a.val()[r].comments){var o=[];for(var c in a.val()[r].comments)o.push(a.val()[r].comments[c]);l.comments=o.reverse()}l.likes&&l.likes[e.props.uid]&&(l.liked=!0),n.push(l)}}))};for(var l in a.val())r(l);e.setState({posts:n.reverse(),loading:!1})}))}))},e.postComment=function(t,a,n){t.preventDefault(),console.log("post",a,n),D.database().ref("users/"+e.props.uid).once("value",(function(t){var s={username:t.val().username,profilePicture:t.val().profilePicture,uid:e.props.uid,date:Date.now(),comment:a};D.database().ref("posts/"+n+"/comments").push(s).then((function(){re("success")}))}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=D.auth().currentUser;if(this.setState({loading:!0}),e){null===localStorage.getItem("hasUsedSkychat")&&localStorage.setItem("hasUsedSkychat",!0);var t=Object(v.a)({},this.state.userData);t.profilePicture=e.photoURL,t.uid=e.uid,t.username=e.displayName.toLowerCase(),this.setState({loading:!1,shouldLogout:!1,userData:t})}else this.setState({shouldLogout:!0,loading:!1});document.title="News feed | Skychat";var a=localStorage.getItem("skychatTheme"),n=document.querySelector("meta[name=theme-color]");"dark"===a?n.setAttribute("content"," #171e25"):"light"===a&&n.setAttribute("content"," #fff"),this.props.uid&&this.getPosts()}},{key:"componentDidUpdate",value:function(){this.state.shouldLogout&&this.props.history.push("/login?feed")}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:pt.a.wrapper+" pt-2 mx-auto"},this.state.toast?s.a.createElement(f,{message:this.setState.toast}):null,this.state.loading?s.a.createElement("div",{style:{height:"79vh",marginBottom:"3rem"}},s.a.createElement(S,{style:{background:"var(--gray)"}})," ",s.a.createElement("p",{className:pt.a.brand},"skychat by odunmilade")):this.state.posts.map((function(t){return s.a.createElement(Xe,Object.assign({},t,{postComment:function(a,n){e.postComment(a,n,t.id)},key:t.id,deletePost:function(){e.deletePost(t.id,t.storageRef)},likeeId:e.props.uid}))})),s.a.createElement("p",{className:"text-center"},"No more posts "))}}]),a}(n.Component),ft=Object(d.g)(gt),vt=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={userData:{username:""},isUser:!1,loading:!1,errorMessage:null,modalMessage:null},e.loadUserdata=function(){e.setState({loading:!0}),D.auth().onAuthStateChanged((function(t){if(t){var a={username:t.displayName.toLowerCase(),email:t.email,profilePicture:t.photoURL,uid:t.uid},n=Object(v.a)({},e.state.userdata);for(var s in a)n[s]=a[s];e.setState({userData:n,loading:!1})}else e.setState({errorMessage:"You are not logged in",loading:!1}),setTimeout((function(){e.setState({errorMessage:null})}),1500)}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.loadUserdata()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:je.a.Profile},s.a.createElement(Oe,{profile:this.props.match.params.profile}),this.state.loading?s.a.createElement("div",{style:{height:"80vh"}},s.a.createElement(S,{style:{background:"var(--gray)"}})," ",s.a.createElement("p",{className:je.a.brand},"skychat by odunmilade")):s.a.createElement(s.a.Fragment,null,this.state.errorMessage?s.a.createElement(ke,{type:"danger",show:!0},this.state.errorMessage):"",s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/notifications",exact:!0,render:function(){return s.a.createElement(lt,e.state)}}),s.a.createElement(d.b,{path:"/feed",render:function(){return s.a.createElement(ft,e.state.userData)}}),s.a.createElement(d.b,{path:"/menu",render:function(){return s.a.createElement(dt,e.props)}}),s.a.createElement(d.b,{path:"/:profile",exact:!0,render:function(){return s.a.createElement(nt,e.state)}}))))}}]),a}(n.Component),bt=a(43),Et=a.n(bt),yt=a(39),Nt=a.n(yt),kt=a(56),wt=a.n(kt),St=a(40),xt=a.n(St),Dt=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={form:{email:{elementType:"input",elementConfig:{type:"email",placeholder:"Email Address",required:!0},value:"",id:"email",label:"Email address"},password:{elementType:"input",elementConfig:{required:!0,type:"password",minLength:6,placeholder:"Your password"},value:"",label:"Your password",id:"password"}},errorMessage:null,sMessage:"Please Wait ! ! !",loading:!1,userExist:null,shouldLogin:!1,toast:null},e.inputChanged=function(t,a){var n=Object(v.a)({},e.state.form),s=Object(v.a)({},n[a]);s.value=t.target.value,n[a]=s,e.setState({form:n})},e.googleLogin=function(){var t=new D.auth.GoogleAuthProvider;e.setState({loading:!0,sMessage:"Checking info"}),D.auth().signInWithRedirect(t).then((function(){return D.auth().getRedirectResult()})).then((function(t){var a=t.user;!0===t.additionalUserInfo.isNewUser?(e.setState({toast:"Finish setting up your skymail account"}),e.saveUser(a)):e.fetchUser(a)})).catch((function(t){var a=t.message;e.setState({errorMessage:s.a.createElement("span",null,s.a.createElement("strong",null,"Failed "),a),loading:!1})}))},e.fetchUser=function(t){var a;if(null!=t)a=t.uid,e.setState({loading:!1,errorMessage:null,shouldLogin:!0});else{var n=s.a.createElement("strong",null,"Failed");e.setState({loading:!1,errorMessage:n})}if(e.state.shouldLogin){var r=e.props.location.search;r?e.props.history.push("/"+r.substr(1)):e.props.history.push("/"+a)}},e.saveUser=function(t){var a=D.database().ref("users/"),n=t.uid;e.setState({loading:!0,sMessage:"Completing Signup  !"}),a.child(n).set({username:t.displayName.toLowerCase(),coverPhoto:xt.a,profilePicture:t.photoURL}).then((function(){e.setState({loading:!1,errorMessage:null}),console.log("success"),e.props.history.push(n)})).catch((function(){e.setState({loading:!1,errorMessage:"Failed to save user to database"})}))},e.signInHandler=function(t){t.preventDefault(),e.setState({loading:!0});var a={};for(var n in e.state.form)a[n]=e.state.form[n].value;D.auth().signInWithEmailAndPassword(a.email,a.password).then((function(t){var a=t.user;e.fetchUser(a)})).catch((function(t){var a=t.message;e.setState({loading:!1,errorMessage:a})}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;document.title="Login | Skychat",D.auth().getRedirectResult().then((function(t){if(t.credential){var a=t.user;!0===t.additionalUserInfo.isNewUser?(e.setState({toast:"Finish setting up your skymail account"}),e.saveUser(a)):e.fetchUser(a)}})).catch((function(e){e.code,e.message}))}},{key:"render",value:function(){var e=this,t=[];for(var a in this.state.form)t.push({id:a,config:this.state.form[a]});return this.state.loading?s.a.createElement(S,{message:this.state.sMessage}):s.a.createElement("form",{onSubmit:this.signInHandler},this.state.errorMessage?s.a.createElement(ke,{type:"warning",show:!0},this.state.errorMessage):null,this.state.toast?s.a.createElement(f,null,this.state.toast):null,t.map((function(t){return s.a.createElement(I,{elementType:t.config.elementType,elementConfig:t.config.elementConfig,value:t.config.value,id:t.id,key:t.config.id,label:t.config.label,changed:function(a){e.inputChanged(a,t.id)}})})),s.a.createElement("button",{className:wt.a.btnLogin+" btn wow fadeInUp btn-lg btn-block  text-uppercase font-weight-bold mb-2",type:"submit"},"Sign in"),s.a.createElement("p",{className:"text-center text-primary"}," Or"),s.a.createElement("button",{className:wt.a.googleBtn+" wow fadeInUp btn btn-lg btn-block  mb-2",type:"button",onClick:this.googleLogin},s.a.createElement("img",{src:Nt.a,alt:" ",style:{width:"2rem"},className:"mr-4"}),"Sign up with google"),s.a.createElement("div",{className:"text-center wow fadeIn"},s.a.createElement(u.b,{className:"small",to:"./home"},"Forgot password?")," ",s.a.createElement("br",null),s.a.createElement(u.b,{className:"small",to:"/SignUp"},"Create new account")))}}]),a}(n.Component),Ct=a(57),jt=a.n(Ct),It=a(78),Mt=a.n(It),Ot=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={form:{username:{elementType:"input",elementConfig:{type:"text",placeholder:"Username",required:!0},value:"",id:"usernme",label:"Username"},email:{elementType:"input",elementConfig:{type:"email",placeholder:"Email",required:!0},value:"",id:"email",label:"Email"},password:{elementType:"input",elementConfig:{required:!0,type:"password",placeholder:"Your password"},value:"",label:"Your password",id:"password"}},userData:{},uid:null,errorMessage:null,sMessage:null,loading:!0},e.inputChanged=function(t,a){var n=Object(v.a)({},e.state.form),s=Object(v.a)({},n[a]);s.value=t.target.value,n[a]=s,e.setState({form:n})},e.googleLogin=function(){var t=new D.auth.GoogleAuthProvider;e.setState({loading:!0,sMessage:"Checking info  !"}),D.auth().signInWithRedirect(t).then((function(){return D.auth().getRedirectResult()})).then((function(t){var a=t.user;e.saveUser(a)})).catch((function(t){var a=t.message;e.setState({errorMessage:a,loading:!1})}))},e.saveUser=function(t){var a=D.database().ref("users/");e.setState({loading:!0,sMessage:"Processing !"}),a.once("value",(function(n){var s=t.uid;n.val()[s]?e.setState({loading:!1,userExist:!0,photo:n.val()[s].profilePicture,name:n.val()[s].username}):(e.setState({loading:!0,sMessage:"Completing Signup  !"}),a.child(s).set({username:t.displayName.toLowerCase(),coverPhoto:xt.a,profilePicture:t.photoURL}).then((function(){alert("then"),e.setState({loading:!1,errorMessage:null,redirect:s})})).catch((function(){e.setState({loading:!1,errorMessage:"Failed to save user to database"})})))}))},e.signUpHandler=function(t){t.preventDefault(),e.setState({loading:!0,sMessage:"Checking info"});var a={};for(var n in e.state.form)a[n]=e.state.form[n].value;D.database().ref("users").once("value",(function(t){e.setState({sMessage:"Wait na  ..."});var n=!1;for(var r in t.val())a.username.toLowerCase()===t.val()[r].username.toLowerCase()&&(n=!0);n?e.setState({errorMessage:s.a.createElement("span",null,"Username ",s.a.createElement("strong",null,a.username)," Exists. Please"," ",s.a.createElement("strong",null,"Pick another username")),loading:!1}):D.auth().createUserWithEmailAndPassword(a.email,a.password).then((function(t){var n=D.auth().currentUser;e.setState({sMessage:"Please wait"}),e.saveUser(n),n.updateProfile({displayName:a.username.toLowerCase(),photoURL:Mt.a}).then((function(){})).catch((function(t){e.setState({loading:!1,errorMessage:"Failed Authenticate"})}))})).catch((function(t){var a=t.message;e.setState({loading:!1,errorMessage:a})}))}))},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){this.setState({loading:!1})}},{key:"render",value:function(){var e=this,t=[];for(var a in this.state.form)t.push({id:a,config:this.state.form[a]});return this.state.loading?s.a.createElement(S,{message:this.state.sMessage}):this.state.redirect?s.a.createElement(d.a,{to:"/feed"}):this.state.userExist?s.a.createElement("div",{className:"d-flex flex-column justify-content-center"},s.a.createElement("img",{src:this.state.photo,alt:"",className:"rounded-circle mx-auto my-2",style:{height:"5rem"}}),s.a.createElement("p",null,"An account was found for ",this.state.name,". If this is you,"," ",s.a.createElement(u.b,{to:"login"},"Proceed to login")," else"," ",s.a.createElement(u.b,{onClick:function(){e.setState({userExist:!1})},to:"SignUp"},"Try again with another email")," ")):s.a.createElement("form",{onSubmit:this.signUpHandler},this.state.errorMessage?s.a.createElement(ke,{type:"danger",show:!0},this.state.errorMessage):"",t.map((function(t){return s.a.createElement(I,{elementType:t.config.elementType,elementConfig:t.config.elementConfig,value:t.config.value,id:t.id,key:t.config.id,label:t.config.label,changed:function(a){e.inputChanged(a,t.id)}})})),s.a.createElement("button",{className:jt.a.btnLogin+" btn btn-lg btn-block  wow fadeInUp  text-uppercase font-weight-bold mb-2",type:"submit"},"Sign Up"),s.a.createElement("p",{className:"text-center text-primary"}," Or"),s.a.createElement("button",{className:jt.a.googleBtn+"  wow fadeInUp btn btn-lg btn-block  mb-2",type:"button",onClick:this.googleLogin},s.a.createElement("img",{src:Nt.a,alt:" ",style:{width:"2rem"},className:"mr-4"}),"Sign up with google"),s.a.createElement("div",{className:"text-center  wow fadeInUpBig"},s.a.createElement(u.b,{className:"small",to:"/login"},"Already have an accout, Login")))}}]),a}(n.Component),Pt=Object(d.g)(Ot),Ut=function(e){return document.querySelector("meta[name=theme-color]").setAttribute("content","var(--white)"),s.a.createElement("div",{className:"container-fluid "+Et.a.Account},s.a.createElement("div",{className:"row no-gutter"},s.a.createElement("div",{className:"  col-md-4 col-lg-6 d-none d-md-flex align-items-center "+Et.a.bgImage}),s.a.createElement("div",{className:Et.a.login+" col-md-8 px-0 bg-white col-lg-6"},s.a.createElement("div",{className:"h-100 d-flex align-items-center py-4 "},s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-md-9   col-lg-8 mx-auto"},s.a.createElement(z,{type:"l1",width:"90%"}),s.a.createElement("div",{className:"px-3 my-4"},"/login"===e.location.pathname?s.a.createElement("h3",null,"Welcome back !"):s.a.createElement("h5",null,"Get started with us today ! ")),s.a.createElement(d.b,{path:"/signUp",component:Pt}),s.a.createElement(d.b,{path:"/login",component:Dt}))))))))},Ft=function(e){Object(i.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={toast:null},e}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=":root { --blue: #007bff; --indigo: #6610f2; --purple: #6f42c1; --pink: #e83e8c; --red: #fbeaec; --orange: #fd7e14; --yellow: #ffc107; --green: #28a745; --teal: #20c997; --cyan: #17a2b8; --white: #171e25; --gray: #101010; --gray-dark: #aaa; --primary: #007bff; --secondary: #777; --success: #28a745; --info: #17a2b8; --warning: #ffc107; --danger: #dc3545; --light: #11161b; --dark: #f7f7f7; --black: #fff;  }",t=localStorage.getItem("skychatTheme"),a=e,n=document.querySelector("meta[name=theme-color]");null===t?localStorage.setItem("skychatTheme","light"):"dark"===t?(a=e,n.setAttribute("content"," #171e25")):"light"===t&&(n.setAttribute("content"," #fff"),a=":root { --blue: #007bff; --indigo: #6610f2; --purple: #6f42c1; --pink: #e83e8c; --red: #dc3545; --orange: #fd7e14; --yellow: #ffc107; --green: #28a745; --teal: #20c997; --cyan: #17a2b8; --white: #fff; --gray: #eee; --black: #000; --gray-dark: #777; --primary: #007bff; --secondary: #ddd; --success: #28a745; --info: #17a2b8; --warning: #ffc107; --danger: #dc3545; --light: #f9f9f9; --dark: #343a40;  }"),console.log(t),document.getElementById("style").innerHTML=a,localStorage.getItem("hasUsedSkychat")&&this.setState({shouldRedirect:!0})}},{key:"render",value:function(){return s.a.createElement(u.a,null,window.innerWidth<1200?s.a.createElement(h,{show:!1,click:this.toggleFullscreen,btn:"Toggle Fullscreen"},"This app is best enjoyed in fullscreen"):null,s.a.createElement("style",{id:"style"}),this.state.toast?s.a.createElement(f,null,this.state.toast):null,s.a.createElement(d.d,null,s.a.createElement(d.b,{path:"/login",exact:!0,component:Ut}),s.a.createElement(d.b,{path:"/signUp",exact:!0,component:Ut}),s.a.createElement(d.b,{path:"/messages/:chatId",component:Ee}),s.a.createElement(d.b,{path:"/messages/",component:Ee}),s.a.createElement(d.a,{from:"/undefined",to:"/"}),s.a.createElement(d.b,{path:"/notifications",exact:!0,component:vt}),s.a.createElement(d.b,{path:"/menu",component:vt}),s.a.createElement(d.b,{path:"/feed",component:vt}),s.a.createElement(d.b,{path:"/edit-profile",component:we}),s.a.createElement(d.b,{path:"/:profile",exact:!0,component:vt}),s.a.createElement(d.b,{path:"/",component:De}),s.a.createElement(d.b,{render:function(){return s.a.createElement("h1",null,"Not found")}})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(93);document.addEventListener("deviceready",(function(){l.a.render(s.a.createElement("div",null,s.a.createElement(Ft,{cordovaWork:!0})),document.getElementById("root"))}),!1),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[79,1,2]]]);
//# sourceMappingURL=main.00bc93a4.chunk.js.map